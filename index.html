<!DOCTYPE html>
<!--
╔═══════════════════════════════════════════════════════════════════════╗
║  POWER TRANSFORMER INSPECTION FORM v0.85 - SAVE ALL ENHANCED          ║
║  ✓ Save All button verified - Complete inspection package in one ZIP  ║
║  ✓ Generates: Excel Report, Executive Summary, Photo List, Gallery    ║
║  ✓ Photo Gallery: 4 photos per page with proper pagination            ║
║  ✓ Enhanced progress tracking and error handling                      ║
║  ✓ Detailed logging for troubleshooting                              ║
╚═══════════════════════════════════════════════════════════════════════╝
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Transformer Inspection Form v0.80</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>




/* v0.68 – Larger buttons/icons + wider notes on desktop */
.status-btn { font-size: 1.3rem; padding: 0.4rem 0.6rem; }
.section-header .expand-icon { font-size: 1.6rem; }

@media (min-width: 1024px) {
  .inspection-section thead th:nth-child(3) { width: 25% !important; } /* Status */
  .inspection-section thead th:nth-child(4) { width: 30% !important; } /* Notes */
  .inspection-section textarea { width: 100% !important; }
}

/* v0.64 – Section slide + fade animation */
.section-content {
  display: block !important;
  max-height: 0;
  opacity: 0;
  overflow: hidden;
  transition: max-height 0.3s ease, opacity 0.3s ease;
}
.section-content.expanded {
  display: block !important;
  max-height: 2000px; /* sufficiently large to accommodate content */
  opacity: 1;
}

/* v0.63 – UX: Embedded binary dropdown inside Notes */
.note-wrapper { position: relative; }
.note-wrapper textarea { padding-right: 2.25rem; }
.ynk-trigger {
  position: absolute; top: 8px; right: 8px;
  width: 28px; height: 28px;
  border: 1px solid #d1d5db; border-radius: 6px;
  background: #f9fafb; cursor: pointer; font-size: 0.9rem; line-height: 1;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.15s, transform 0.05s;
}
.ynk-trigger:hover { background: #eef2ff; }
.ynk-trigger:active { transform: scale(0.97); }
.ynk-menu {
  position: absolute; right: 8px; top: 40px; background: #ffffff;
  border: 1px solid #e5e7eb; border-radius: 8px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.12);
  min-width: 180px; z-index: 50; display: none;
}
.ynk-menu.active { display: block; }
.ynk-menu button {
  width: 100%; padding: 0.5rem 0.75rem; background: white; border: none;
  text-align: left; font-size: 0.9rem; cursor: pointer;
}
.ynk-menu button:hover { background: #f9fafb; }

/* Added chevron animation */
.section-header .expand-icon {
  transition: transform 0.3s ease;
  display: inline-block;
  font-size: 1.2rem;
}
.section-header.collapsed .expand-icon {
  transform: rotate(0deg); /* right */
}
.section-header:not(.collapsed) .expand-icon {
  transform: rotate(45deg); /* down */
}

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f9fafb; padding: 1rem; }
        .container { max-width: 1600px; margin: 0 auto; background: white; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .header-title { background: #005DAA; color: white; padding: 2.5rem 2rem; border-radius: 0.5rem 0.5rem 0 0; position: sticky; top: 0; z-index: 100; transition: padding 0.3s ease; display: flex; align-items: center; justify-content: center; }
        .header-title .header-logo { position: absolute; left: 2rem; }
        .header-logo { height: 120px; width: auto; transition: height 0.3s ease; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }
        .header-title.minimized .header-logo { height: 70px; }
        .header-title h1 { font-size: 1.75rem; margin-bottom: 0; transition: font-size 0.3s ease; font-weight: 600; }
        .header-title.minimized { padding: 1rem 2rem; }
        .header-title.minimized h1 { font-size: 1.35rem; }
        .header-buttons-block { background: #f3f4f6; color: #374151; padding: 1rem 1.5rem; border-top: 2px solid #e5e7eb; border-bottom: 2px solid #e5e7eb; position: sticky; top: 120px; z-index: 99; transition: max-height 0.3s ease, opacity 0.3s ease, padding 0.3s ease; max-height: 100px; opacity: 1; overflow: hidden; }
        .header-buttons-block.minimized { max-height: 0; opacity: 0; padding: 0 1.5rem; }
        .header-buttons { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem; }
        .version { font-size: 0.875rem; opacity: 0.8; font-weight: normal; margin-left: 0.5rem; }
        .auto-save-indicator { display: inline-block; margin-left: 1rem; padding: 0.25rem 0.75rem; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600; }
        .auto-save-indicator.saved { background: #16a34a; color: white; }
        .auto-save-indicator.saving { background: #f59e0b; color: white; }
        .auto-save-indicator.error { background: #dc2626; color: white; }
        .btn { padding: 0.5rem 1rem; border: none; border-radius: 0.375rem; font-weight: 600; cursor: pointer; margin: 0.25rem; transition: all 0.2s; }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn:disabled:hover { opacity: 0.5; transform: none; }
        .btn-green { background: #16a34a; color: white; }
        .btn-blue { background: #2563eb; color: white; }
        .btn-orange { background: #ea580c; color: white; }
        .btn-gray { background: #6b7280; color: white; }
        .btn-purple { background: #9333ea; color: white; }
        .section { padding: 1.5rem; border-bottom: 1px solid #e5e7eb; }
        .section h2 { margin-bottom: 1rem; }
        .checklist-header-wrapper { background: white; position: sticky; top: 60px; z-index: 90; padding: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid #e5e7eb; margin: -1.5rem -1.5rem 0 -1.5rem; transition: top 0.3s ease; }
        .checklist-header-wrapper.header-minimized { top: 50px; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-size: 0.875rem; font-weight: 500; margin-bottom: 0.25rem; }
        .form-group label.required::after { content: " *"; color: #dc2626; }
        .form-group input, .form-group select, .form-group textarea { padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; }
        .form-group input.error, .form-group select.error { border-color: #dc2626; }
        .photo-section { background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-top: 0.5rem; }
        .photo-section h3 { font-size: 1rem; margin-bottom: 0.75rem; color: #374151; }
        .photo-buttons { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-bottom: 1rem; }
        .stat-card { background: white; padding: 1rem; border-radius: 0.375rem; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .stat-value { font-size: 1.5rem; font-weight: bold; }
        .stat-label { font-size: 0.875rem; color: #6b7280; margin-top: 0.25rem; }
        .inspection-section { margin-bottom: 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; overflow: hidden; }
        .section-header { color: white; padding: 0.75rem 1rem; font-weight: bold; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: all 0.2s; user-select: none; }
        .section-header:hover { opacity: 0.95; }
        .section-header .title-area { display: flex; align-items: center; gap: 0.75rem; flex: 1; }
        .section-header .expand-icon { font-size: 1.25rem; }
        .section-header .na-checkbox { display: flex; align-items: center; gap: 0.375rem; background: rgba(255,255,255,0.15); padding: 0.25rem 0.5rem; border-radius: 0.375rem; margin-left: 0.5rem; cursor: pointer; }
        .section-header .na-checkbox input[type="checkbox"] { width: 16px; height: 16px; cursor: pointer; }
        .section-header .na-checkbox label { font-size: 0.875rem; cursor: pointer; user-select: none; }
        .section-content.na-disabled { opacity: 0.5; pointer-events: none; }
        .section-header .completion-badge { background: rgba(255,255,255,0.2); padding: 0.25rem 0.75rem; border-radius: 0.375rem; font-size: 0.875rem; margin-left: auto; }
        .section-content { display: none; }
        .section-content.expanded { display: block; }
        .status-buttons { display: flex; gap: 0.25rem; flex-wrap: wrap; }
        .status-btn { padding: 0.375rem 0.75rem; border: 2px solid transparent; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600; cursor: pointer; transition: all 0.15s; background: #e5e7eb; color: #374151; }
        .status-btn:hover { transform: scale(1.05); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .status-btn.active { border-color: #1f2937; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        .status-btn.pass { background: #C6EFCE; color: #166534; }
        .status-btn.pass.active { border-color: #166534; }
        .status-btn.warning { background: #FFD966; color: #854d0e; }
        .status-btn.warning.active { border-color: #854d0e; }
        .status-btn.fail { background: #FFC7CE; color: #991b1b; }
        .status-btn.fail.active { border-color: #991b1b; }
        .status-btn.skip { background: #D9D9D9; color: #4b5563; }
        .status-btn.skip.active { border-color: #4b5563; }
        /* Gray out non-selected buttons when a status is selected */
        .status-buttons:has(.status-btn.active) .status-btn:not(.active) {
            background: #e5e7eb !important;
            color: #9ca3af !important;
            opacity: 0.5;
        }
        .status-legend { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; font-size: 0.875rem; }
        .legend-item { display: flex; align-items: center; gap: 0.375rem; }
        .legend-icon { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; border-radius: 0.375rem; font-size: 1.1rem; font-weight: 600; }
        .legend-icon.pass { background: #C6EFCE; color: #166534; }
        .legend-icon.warning { background: #FFD966; color: #854d0e; }
        .legend-icon.fail { background: #FFC7CE; color: #991b1b; }
        .legend-icon.skip { background: #D9D9D9; color: #4b5563; }
        .legend-icon.na { background: #e5e7eb; color: #374151; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f3f4f6; padding: 0.5rem; text-align: left; border-bottom: 2px solid #d1d5db; font-size: 0.875rem; }
        td { padding: 0.75rem 0.5rem; border-bottom: 1px solid #e5e7eb; vertical-align: middle; }
        td textarea { width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem; }
        .textarea-wrapper { position: relative; width: 100%; }
        .word-counter { font-size: 0.7rem; color: #6b7280; text-align: right; margin-top: 0.25rem; }
        .word-counter.warning { color: #f59e0b; font-weight: 600; }
        .word-counter.error { color: #dc2626; font-weight: 600; }
        .camera-btn { padding: 0.375rem 0.5rem; background: #3b82f6; color: white; border: none; border-radius: 0.375rem; cursor: pointer; font-size: 0.75rem; font-weight: 600; display: inline-flex; align-items: center; gap: 0.25rem; transition: all 0.2s; white-space: nowrap; }
        .camera-btn:hover { background: #2563eb; transform: translateY(-1px); }
        .photo-upload-btn { padding: 0.5rem 1rem; background: #3b82f6; color: white; border: none; border-radius: 0.375rem; cursor: pointer; font-size: 0.75rem; font-weight: 600; display: inline-flex; align-items: center; gap: 0.375rem; transition: all 0.2s; }
        .photo-upload-btn:hover { background: #2563eb; transform: translateY(-1px); }
        .photo-thumbnails { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem; }
        .photo-thumb { position: relative; width: 80px; height: 80px; border-radius: 0.375rem; overflow: hidden; border: 2px solid #d1d5db; cursor: pointer; transition: all 0.2s; }
        .photo-thumb:hover { border-color: #3b82f6; transform: scale(1.05); }
        .photo-thumb.has-annotation { border-color: #ea580c; border-width: 3px; }
        .photo-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .photo-thumb .delete-btn { position: absolute; top: -4px; right: -4px; width: 20px; height: 20px; background: #dc2626; color: white; border: none; border-radius: 50%; cursor: pointer; font-size: 11px; line-height: 1; display: flex; align-items: center; justify-content: center; z-index: 10; }
        .photo-thumb .delete-btn:hover { background: #991b1b; }
        .photo-thumb .annotation-indicator { position: absolute; bottom: 2px; right: 2px; background: #ea580c; color: white; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
        .photo-thumb .photo-label { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.75); color: white; font-size: 9px; padding: 2px 4px; text-align: center; }
        .line-photo-container { display: flex; gap: 0.5rem; align-items: center; }
        .photo-viewer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 2000; }
        .photo-viewer.active { display: flex; align-items: center; justify-content: center; }
        .photo-viewer-content { position: relative; max-width: 95vw; max-height: 95vh; display: flex; align-items: center; justify-content: center; }
        .photo-viewer img { max-width: 95vw; max-height: 85vh; object-fit: contain; cursor: move; transition: transform 0.3s ease; }
        .photo-viewer-controls { position: absolute; top: 20px; right: 20px; display: flex; gap: 10px; flex-wrap: wrap; z-index: 10; }
        .photo-viewer-nav { position: absolute; top: 50%; transform: translateY(-50%); z-index: 10; }
        .photo-viewer-nav.prev { left: 20px; }
        .photo-viewer-nav.next { right: 20px; }
        .photo-viewer-btn { width: 44px; height: 44px; background: rgba(255,255,255,0.9); border: none; border-radius: 50%; cursor: pointer; font-size: 1.25rem; display: flex; align-items: center; justify-content: center; transition: all 0.2s; font-weight: bold; }
        .photo-viewer-btn:hover { background: white; transform: scale(1.1); }
        .photo-viewer-btn:disabled { opacity: 0.3; cursor: not-allowed; }
        .photo-viewer-btn:active { transform: scale(0.95); }
        .photo-viewer-info { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(255,255,255,0.95); padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600; max-width: 90%; text-align: center; }
        .photo-annotation { position: absolute; top: 80px; right: 20px; background: rgba(255,255,255,0.97); border-radius: 0.5rem; padding: 1.25rem; max-width: 350px; min-width: 300px; display: none; box-shadow: 0 4px 20px rgba(0,0,0,0.3); z-index: 20; }
        .photo-annotation.active { display: block; }
        .photo-annotation h3 { font-size: 1rem; margin-bottom: 0.75rem; color: #1f2937; }
        .photo-annotation textarea { width: 100%; min-height: 100px; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem; margin-bottom: 0.75rem; resize: vertical; font-family: Arial, sans-serif; }
        .photo-annotation .button-group { display: flex; gap: 0.5rem; }
        .photo-annotation button { flex: 1; padding: 0.625rem; border: none; border-radius: 0.375rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .photo-annotation .save-btn { background: #16a34a; color: white; }
        .photo-annotation .save-btn:hover { background: #15803d; }
        .photo-annotation .cancel-btn { background: #6b7280; color: white; }
        .photo-annotation .cancel-btn:hover { background: #4b5563; }
        .network-status { position: fixed; bottom: 20px; right: 20px; background: rgba(0,0,0,0.9); color: white; padding: 0.75rem 1rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600; display: none; z-index: 1500; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .network-status.online { background: #16a34a; }
        .network-status.offline { background: #dc2626; display: block; }
        .network-status.slow { background: #f59e0b; display: block; }
        .storage-warning { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); background: #fefce8; border: 2px solid #f59e0b; border-radius: 0.5rem; padding: 1.25rem; max-width: 500px; display: none; z-index: 1500; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .storage-warning.active { display: block; }
        .storage-warning.critical { background: #fef2f2; border-color: #dc2626; }
        .storage-warning h3 { color: #d97706; margin-bottom: 0.5rem; font-size: 1.125rem; }
        .storage-warning.critical h3 { color: #dc2626; }
        .storage-warning p { margin-bottom: 0.75rem; font-size: 0.875rem; line-height: 1.5; }
        .storage-warning .storage-meter { background: #e5e7eb; height: 8px; border-radius: 4px; margin: 0.75rem 0; overflow: hidden; }
        .storage-warning .storage-meter-fill { background: #f59e0b; height: 100%; transition: width 0.3s; }
        .storage-warning.critical .storage-meter-fill { background: #dc2626; }
        .storage-warning .button-group { display: flex; gap: 0.5rem; margin-top: 1rem; }
        .storage-warning button { padding: 0.5rem 1rem; border: none; border-radius: 0.375rem; font-weight: 600; cursor: pointer; flex: 1; }
        .storage-warning .btn-primary { background: #d97706; color: white; }
        .storage-warning.critical .btn-primary { background: #dc2626; }
        .storage-warning .btn-secondary { background: #6b7280; color: white; }
        .validation-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 3000; align-items: center; justify-content: center; }
        .validation-modal.active { display: flex; }
        .validation-content { background: white; border-radius: 0.75rem; padding: 2rem; max-width: 600px; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .validation-content h2 { color: #1f2937; margin-bottom: 1rem; font-size: 1.5rem; }
        .validation-section { margin-bottom: 1.5rem; }
        .validation-section h3 { color: #374151; font-size: 1.125rem; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
        .validation-section h3 .icon { font-size: 1.25rem; }
        .validation-section h3 .icon.success { color: #16a34a; }
        .validation-section h3 .icon.error { color: #dc2626; }
        .validation-section h3 .icon.warning { color: #f59e0b; }
        .validation-list { list-style: none; padding-left: 0; }
        .validation-list li { padding: 0.5rem; margin-bottom: 0.25rem; border-radius: 0.375rem; font-size: 0.875rem; }
        .validation-list li.error { background: #fef2f2; color: #991b1b; }
        .validation-list li.warning { background: #fefce8; color: #854d0e; }
        .validation-list li.success { background: #f0fdf4; color: #166534; }
        .validation-summary { background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; }
        .validation-summary-item { display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid #e5e7eb; }
        .validation-summary-item:last-child { border-bottom: none; }
        .validation-summary-label { font-weight: 600; color: #374151; }
        .validation-summary-value { color: #6b7280; }
        .validation-buttons { display: flex; gap: 0.75rem; margin-top: 1.5rem; }
        .validation-buttons button { flex: 1; padding: 0.75rem; border: none; border-radius: 0.375rem; font-weight: 600; cursor: pointer; font-size: 1rem; transition: all 0.2s; }
        .validation-buttons .proceed-btn { background: #16a34a; color: white; }
        .validation-buttons .proceed-btn:hover { background: #15803d; }
        .validation-buttons .proceed-btn:disabled { background: #9ca3af; cursor: not-allowed; }
        .validation-buttons .cancel-btn { background: #6b7280; color: white; }
        .validation-buttons .cancel-btn:hover { background: #4b5563; }
        .bulk-actions { padding: 1rem; background: #f9fafb; border-top: 2px solid #e5e7eb; display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .bulk-btn { padding: 0.5rem 1rem; border: none; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .bulk-btn:hover { transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .bulk-pass { background: #C6EFCE; color: #166534; }
        .bulk-skip { background: #D9D9D9; color: #4b5563; }
        .sig-canvas { width: 100%; border: 2px dashed #9ca3af; border-radius: 0.375rem; cursor: crosshair; touch-action: none; }
        .signature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
        .signature-box { display: flex; flex-direction: column; }
        .signature-box h3 { font-size: 1rem; margin-bottom: 0.75rem; color: #374151; }
        .alert { background: #fef2f2; border-left: 4px solid #dc2626; padding: 1rem; margin: 1rem 0; display: none; }
        .success-alert { background: #f0fdf4; border-left: 4px solid #16a34a; padding: 1rem; margin: 1rem 0; display: none; }
        .spinner { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.3); z-index: 1000; text-align: center; }
        .spinner::after { content: ""; width: 40px; height: 40px; border: 4px solid #e5e7eb; border-top-color: #2563eb; border-radius: 50%; animation: spin 1s linear infinite; display: block; margin: 1rem auto 0; }
        .photo-database { padding: 1.5rem; background: #f9fafb; border-radius: 0.5rem; margin-top: 1rem; }
        .photo-database h3 { margin-bottom: 1rem; color: #374151; }
        .photo-database-list { max-height: 300px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem; background: white; }
        .photo-database-item { padding: 0.75rem; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; font-size: 0.875rem; }
        .photo-database-item:last-child { border-bottom: none; }
        .photo-database-item:hover { background: #f9fafb; }
        .photo-database-filename { font-family: monospace; color: #374151; }
        .photo-database-meta { color: #6b7280; font-size: 0.75rem; }
        @keyframes spin { to { transform: rotate(360deg); } }
        /* ==================== PRINT STYLES FOR A4 ==================== */
        @media print {
            /* Page setup for A4 */
            @page {
                size: A4 portrait;
                margin: 10mm 12mm;
            }
            
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            /* Hide interactive elements */
            .header-buttons,
            .btn,
            .bulk-actions,
            .photo-upload-btn,
            .camera-btn,
            .photo-section,
            .network-status,
            .storage-warning,
            .validation-modal,
            .spinner,
            .alert,
            .success-alert,
            .na-checkbox,
            input[type="file"],
            .delete-btn,
            .ynk-trigger,
            .ynk-menu,
            .word-counter {
                display: none !important;
            }
            
            /* Minimize header */
            .header-title {
                padding: 8px 12px !important;
                position: static !important;
                margin-bottom: 0;
            }
            
            .header-logo {
                height: 40px !important;
            }
            
            .header-buttons-block {
                display: none !important;
            }
            
            .header-title h1 {
                font-size: 16pt !important;
                margin-bottom: 2px !important;
            }
            
            .version {
                font-size: 9pt !important;
            }
            
            .auto-save-indicator {
                display: none !important;
            }
            
            /* Compact container */
            .container {
                box-shadow: none !important;
                padding: 0 !important;
                margin: 0 !important;
                max-width: 100% !important;
            }
            
            /* Compact section styling */
            .section {
                padding: 6px 8px !important;
                border-bottom: 1px solid #d1d5db !important;
                page-break-inside: avoid;
            }
            
            .section h2 {
                font-size: 11pt !important;
                margin-bottom: 4px !important;
            }
            
            /* Transformer information form grid */
            .form-grid {
                gap: 4px !important;
                page-break-inside: avoid;
            }
            
            .form-group {
                margin-bottom: 2px !important;
            }
            
            .form-group label {
                font-size: 8pt !important;
                margin-bottom: 1px !important;
                font-weight: 600 !important;
            }
            
            .form-group input,
            .form-group select {
                font-size: 9pt !important;
                padding: 2px 4px !important;
                border: 1px solid #d1d5db !important;
            }
            
            /* Stats grid - more compact */
            .stats-grid {
                gap: 4px !important;
                margin-bottom: 6px !important;
                grid-template-columns: repeat(6, 1fr) !important;
            }
            
            .stat-card {
                padding: 4px 6px !important;
                box-shadow: none !important;
                border: 1px solid #e5e7eb !important;
            }
            
            .stat-value {
                font-size: 11pt !important;
                font-weight: 700 !important;
            }
            
            .stat-label {
                font-size: 7pt !important;
                margin-top: 0 !important;
            }
            
            /* Inspection sections */
            .inspection-section {
                page-break-inside: avoid;
                margin-bottom: 6px !important;
                border: 1px solid #d1d5db !important;
            }
            
            .section-header {
                padding: 4px 8px !important;
                font-size: 10pt !important;
                page-break-after: avoid;
            }
            
            .section-header .expand-icon {
                display: none !important;
            }
            
            .section-header .completion-badge {
                font-size: 8pt !important;
                padding: 2px 6px !important;
            }
            
            .section-content {
                display: block !important;
                max-height: none !important;
                opacity: 1 !important;
                overflow: visible !important;
            }
            
            /* Tables - compact layout */
            table {
                width: 100% !important;
                font-size: 8pt !important;
                border-collapse: collapse !important;
            }
            
            th {
                padding: 3px 4px !important;
                font-size: 8pt !important;
                background: #f3f4f6 !important;
                border: 1px solid #d1d5db !important;
                font-weight: 600 !important;
            }
            
            td {
                padding: 3px 4px !important;
                border: 1px solid #e5e7eb !important;
                vertical-align: top !important;
                font-size: 8pt !important;
                line-height: 1.2 !important;
            }
            
            /* Status buttons - smaller for print */
            .status-buttons {
                gap: 1px !important;
            }
            
            .status-btn {
                padding: 2px 4px !important;
                font-size: 9pt !important;
                border: 1px solid transparent !important;
                min-width: 22px !important;
                height: 22px !important;
            }
            
            .status-btn:not(.active) {
                opacity: 0.3 !important;
            }
            
            /* Status legend - compact */
            .status-legend {
                gap: 6px !important;
                font-size: 7pt !important;
                margin-bottom: 4px !important;
            }
            
            .legend-item {
                gap: 2px !important;
            }
            
            .legend-icon {
                width: 18px !important;
                height: 18px !important;
                font-size: 9pt !important;
            }
            
            /* Notes display - show textarea content */
            textarea {
                display: block !important;
                border: none !important;
                background: transparent !important;
                resize: none !important;
                font-size: 7pt !important;
                line-height: 1.2 !important;
                padding: 0 !important;
                overflow: visible !important;
                height: auto !important;
                min-height: auto !important;
                color: #374151 !important;
            }
            
            /* Hide photo column or minimize */
            td:nth-child(5),
            th:nth-child(5) {
                display: none;
            }
            
            /* Show N/A Summary in print */
            .na-summary {
                display: block !important;
                background: #fef3c7;
                border: 2px solid #f59e0b;
                border-radius: 0.375rem;
                padding: 8px 12px;
                margin: 8px 0;
                page-break-inside: avoid;
                page-break-after: avoid;
            }
            
            .na-summary h3 {
                font-size: 10pt !important;
                color: #92400e;
                margin-bottom: 4px !important;
            }
            
            .na-summary ul {
                margin: 4px 0 0 16px;
                font-size: 8pt;
                line-height: 1.4;
                color: #78350f;
            }
            
            .na-summary li {
                margin: 2px 0;
            }
            
            /* Hide sections marked as N/A in print */
            .inspection-section.section-na {
                display: none !important;
            }
            
            /* Adjust column widths for print without photo column */
            .inspection-section thead th:nth-child(1) { width: 8% !important; }
            .inspection-section thead th:nth-child(2) { width: 42% !important; }
            .inspection-section thead th:nth-child(3) { width: 25% !important; }
            .inspection-section thead th:nth-child(4) { width: 25% !important; }
            
            /* Keep rows together */
            tr {
                page-break-inside: avoid;
            }
            
            /* Ensure section doesn't break */
            .checklist-header-wrapper {
                position: static !important;
                padding: 4px 8px !important;
                margin: 0 !important;
                page-break-after: avoid;
            }
            
            /* Section comments styling for print */
            .section-content > div[style*="background: #f9fafb"] {
                padding: 6px 8px !important;
                background: #f9fafb !important;
                border-top: 1px solid #e5e7eb !important;
                page-break-inside: avoid !important;
            }
            
            .section-content > div[style*="background: #f9fafb"] label {
                font-size: 8pt !important;
                font-weight: 700 !important;
                margin-bottom: 2px !important;
            }
            
            .section-content > div[style*="background: #f9fafb"] textarea {
                font-size: 7pt !important;
                line-height: 1.2 !important;
                padding: 2px 4px !important;
                border: 1px solid #d1d5db !important;
            }
            
            /* Signatures section */
            .signature-grid {
                grid-template-columns: 1fr 1fr !important;
                gap: 8px !important;
                page-break-inside: avoid;
            }
            
            /* Disclaimer header styling for print */
            #signatures-section > div[style*="background: #005DAA"] {
                background: #005DAA !important;
                padding: 6px 10px !important;
                margin-bottom: 8px !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
            }
            
            #signatures-section > div[style*="background: #005DAA"] h2 {
                color: white !important;
                font-size: 10pt !important;
                font-weight: 700 !important;
                margin: 0 !important;
            }
            
            /* Disclaimer text styling for print */
            #disclaimer-text {
                font-size: 7pt !important;
                line-height: 1.3 !important;
                margin-bottom: 10px !important;
                page-break-inside: avoid !important;
            }
            
            #disclaimer-text p {
                margin-bottom: 4px !important;
            }
            
            #disclaimer-text ul {
                margin-left: 12px !important;
                margin-bottom: 4px !important;
            }
            
            #disclaimer-text li {
                margin-bottom: 2px !important;
            }
            
            /* Keep Comments and Signatures together on same page */
            #comments-section {
                page-break-after: avoid !important;
                page-break-inside: avoid !important;
            }
            
            #signatures-section {
                page-break-before: avoid !important;
                page-break-inside: avoid !important;
            }
            
            .signature-box h3 {
                font-size: 9pt !important;
                margin-bottom: 2px !important;
            }
            
            .sig-canvas {
                border: 1px solid #9ca3af !important;
                height: 60px !important;
            }
            
            /* Accepted signature overlay for print */
            .signature-box > div[style*="position: relative"] > div[id*="AcceptedOverlay"] {
                display: block !important;
            }
            
            .signature-box > div[style*="position: relative"] > div[id*="AcceptedOverlay"] span {
                padding: 2px 6px !important;
                font-size: 7pt !important;
                position: absolute !important;
                bottom: 4px !important;
                right: 4px !important;
            }
            
            /* General text sizing */
            body {
                font-size: 9pt !important;
                line-height: 1.3 !important;
            }
            
            /* Remove backgrounds that waste ink */
            .stat-card[style*="background:#16a34a"],
            .stat-card[style*="background:#f59e0b"],
            .stat-card[style*="background:#dc2626"] {
                border: 2px solid currentColor !important;
            }
        }
        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .form-grid { grid-template-columns: 1fr; }
            .photo-viewer-controls { top: 10px; right: 10px; }
            .photo-annotation { max-width: 90vw; right: 5vw; top: 60px; }
        }

    </style>
</head>
<body>

<div class="container">
    <div class="header-title" id="headerTitle">
        <img src="data:image/webp;base64,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CD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCye+2aul+pEJ/SGXBv/UiHrol6hv/UiHrol6hv/UiF/AoP/fqRD1w/CigCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygZ6N9WYM6K84GuiXoo1HztKnLfFKN36cTH+NmWgXMlcDNyosgwqtvhjk/9G4rk604x8CRqZRXLkt59jMNZbj+uvnabjqn2jOeoRZhSYUtaUJJwnNYnOLFDv0JrBQ9amtCg5XUNwTR8gKKAIPWBZQNQBB6wLKBqAIPWBZQNQBB6wLKBqAIPWBZPfPu0BP6Qy4N/0REqMNvXm+rj5Bbp8V4rr4t36Wd6kKX99yHnudzNgWcY74C4Rllo7cBlgb730aSbt3Fak40ef2pQNRBET0a2YorBNHx1ikDUSVdEyGUki71lA1AEHrAsoGoAg9YFlA1AEHrAsoGoAg9YFlA1AEHqmRX5f5DZ6TeKn6+7dWfO/T8c87ppyRV+QbdnzBK9X5ygWUDUAQesCygahdRX5pGxtKTFdZkB9db4HbbZQ1mTowLWsIs/6tJaOMDCigCD1gWUDUAQesCygagCD1gWUDUAQesCygZ6N9WS5MdSeOiCa5iVO5Sr05E6SL1lA1AEHrAsoGoAg9YFlAzyG/3j0xZwstMcAtd0tfswFsi6tIuBfS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DUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gWUDUAQesCygagCD1gQAAA/uOYwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJf+vgP3+vgAAAAAAGt/XwMH+vgCe3oFDRm0mPjjZ96348HpkgwAa+gvq23eyJdHrKJGPqlSI/HMzaPDBiw9nNV13oZ1cM84aRae+lvoG8FHvJl5aQgG9JPuKhh6+KfAhipZIQSk3SpYfVlgobXpRytgLpqiVZJElbpiL9F0K/Q6DHlLGPJNP81rNH7+bHBLgyqd1y2uEKA9N0bJNIqp+H9rkui8288uZymjCfzci5ZM82qzOPyyXiCsZrADBVJ5DbY7y+KJsG8MIuJ0ZPPMDlgh54ZUjIyFCIbIPY7Nu5hoaoJfMjJRyEbYMFRIIQPPy6+coyNU0ZrRmwXkjv6riFJyyaoj8peHQqp0DhHN8/smqARpDJB0lelAfnpNdZFftjcbOjWk9oGvQ/vc+v/FYDKoFZKprERr6IUA0K+dW3XpFRFDQP+ueBvAWiI6wxuVrpZsvVWVtyFPlA/vIL//c87phW23E6AJBhBb3IP6d2cWO17m53+8SSFTXvCa48192akBbjhySrDhaeeqaVwgiUQV6JwZxDaJ9tece9dFLleJzMT0gUv5bL+BOsk2O3IGeENEXVNEL/19T3ZdN7Sub/TSm3f8M8CGzxUlZ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" alt="Doble Logo" class="header-logo">
        <h1>Power Transformer Inspection Form <span style="font-size: 0.5em; font-weight: 500; color: #6b7280; margin-left: 0.5rem;">v0.84</span></h1>
    </div>
    
    <div class="header-buttons-block" id="headerButtonsBlock">
        <div class="header-buttons">
            <div>
                <span class="auto-save-indicator saved" id="autoSaveStatus">Auto-saved</span>
                <span id="storageIndicator" style="margin-left:1rem; font-size:0.75rem; opacity:0.9;"></span>
            </div>
            <div>
                <button class="btn btn-green" onclick="loadAutoSave()">📂 Load</button>
                <button class="btn btn-blue" onclick="validateAndExport()">📊 Export</button>
                <button class="btn btn-green" onclick="saveAllDocuments()">💾 Save All</button>
                <button class="btn btn-orange" onclick="sendViaEmail()">📧 Send Email</button>
                <button class="btn btn-blue" onclick="showExecutiveSummary()">📋 Summary</button>
                <button class="btn btn-purple" onclick="showPhotoDatabase()">📷 Photo DB</button>
                <button class="btn btn-gray" onclick="clearAutoSave()">🗑️ Clear</button>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>Transformer Information</h2>
        <div class="form-grid">
            <div class="form-group">
                <label class="required">Transformer ID</label>
                <input type="text" id="transformerId" placeholder="e.g., TX-001" maxlength="50" oninput="markUnsaved()" required>
            </div>
            <div class="form-group">
                <label class="required">Location</label>
                <input type="text" id="location" placeholder="e.g., Main Substation" maxlength="100" oninput="markUnsaved()" required>
            </div>
            <div class="form-group">
                <label>GPS Coordinates</label>
                <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="text" id="gpsCoordinates" placeholder="Latitude, Longitude" maxlength="50" oninput="markUnsaved()" style="flex: 1;">
                    <button type="button" class="btn btn-blue" onclick="getGPSLocation()" style="padding: 0.5rem; margin: 0;">📍 GPS</button>
                </div>
            </div>
            <div class="form-group">
                <label class="required">Manufacturer</label>
                <input type="text" id="manufacturer" placeholder="e.g., ABB" maxlength="50" oninput="markUnsaved()" required>
            </div>
            <div class="form-group">
                <label>Max. MVA</label>
                <input type="text" id="rating" placeholder="e.g., 50" maxlength="20" oninput="markUnsaved()">
            </div>
            <div class="form-group">
                <label>Voltage Ratio (HV/LV/TV) (kV)</label>
                <input type="text" id="voltage" placeholder="e.g., 132/33/11" maxlength="50" oninput="markUnsaved()">
            </div>
            <div class="form-group">
                <label>Cooling Type</label>
                <select id="coolingType" onchange="markUnsaved()">
                    <option value="">Select cooling type...</option>
                    <optgroup label="IEC Designations - Single Stage">
                        <option value="ONAN">ONAN - Oil Natural Air Natural</option>
                        <option value="ONAF">ONAF - Oil Natural Air Forced</option>
                        <option value="OFAF">OFAF - Oil Forced Air Forced</option>
                        <option value="OFWF">OFWF - Oil Forced Water Forced</option>
                        <option value="ODAF">ODAF - Oil Directed Air Forced</option>
                        <option value="ODWF">ODWF - Oil Directed Water Forced</option>
                    </optgroup>
                    <optgroup label="IEC Designations - Multi Stage">
                        <option value="ONAN/ONAF">ONAN/ONAF - Natural/Forced Air</option>
                        <option value="ONAN/ONAF1/ONAF2">ONAN/ONAF1/ONAF2 - Natural/Forced Air/Forced Air</option>
                        <option value="ONAN/OFAF">ONAN/OFAF - Natural/Forced Oil & Air</option>
                        <option value="ONAN/ONAF/OFAF">ONAN/ONAF/OFAF - Natural/Forced Air/Forced Oil & Air</option>
                        <option value="ONAF/OFAF">ONAF/OFAF - Forced Air/Forced Oil & Air</option>
                        <option value="OFAF/ODAF">OFAF/ODAF - Forced Oil Air/Directed Oil Air</option>
                        <option value="ONAN/ODAF">ONAN/ODAF - Natural/Directed Oil Air</option>
                        <option value="ONAF/ONAF">ONAF/ONAF - Forced Air/Forced Air</option>
                        <option value="OFAF/OFAF">OFAF/OFAF - Forced Oil Air/Forced Oil Air</option>
                        <option value="ONAN/ONWF">ONAN/ONWF - Natural/Natural Oil Water Forced</option>
                        <option value="OFWF/OFWF">OFWF/OFWF - Forced Oil Water/Forced Oil Water</option>
                    </optgroup>
                    <optgroup label="ANSI/IEEE Designations">
                        <option value="OA">OA - Oil Immersed Self Cooled</option>
                        <option value="FA">FA - Oil Immersed Forced Air Cooled</option>
                        <option value="FOA">FOA - Oil Immersed Forced Oil Cooled with Forced Air</option>
                        <option value="FOW">FOW - Oil Immersed Forced Oil Cooled with Forced Water</option>
                        <option value="OA/FA">OA/FA - Self Cooled/Forced Air Cooled</option>
                        <option value="OA/FA/FA">OA/FA/FA - Self Cooled/Forced Air Cooled/Forced Air Cooled</option>
                        <option value="OA/FOA">OA/FOA - Self Cooled/Forced Oil & Air Cooled</option>
                        <option value="OA/FOA/FOA">OA/FOA/FOA - Self Cooled/Forced Oil & Air/Forced Oil & Air</option>
                    </optgroup>
                </select>
            </div>
            <div class="form-group">
                <label>Oil Preservation System</label>
                <select id="oilPreservationSystem" onchange="markUnsaved()">
                    <option value="">Select preservation system...</option>
                    <option value="Free Breathing">Free Breathing (with Silica Gel Breather)</option>
                    <option value="Conservator">Conservator with Breather</option>
                    <option value="Sealed Nitrogen">Sealed (Nitrogen Cushion)</option>
                    <option value="Sealed Inert Gas">Sealed (Inert Gas Cushion)</option>
                    <option value="Diaphragm Conservator">Diaphragm/Bladder Conservator</option>
                    <option value="Positive Pressure">Positive Pressure Inert Gas System</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label>Serial Number</label>
                <input type="text" id="serialNumber" placeholder="e.g., SN-12345" maxlength="50" oninput="markUnsaved()">
            </div>
            <div class="form-group">
                <label>Year of Manufacture</label>
                <select id="year" onchange="markUnsaved()">
                    <option value="">Select year...</option>
                </select>
            </div>
            <div class="form-group">
                <label class="required">Status</label>
                <select id="status" required onchange="markUnsaved()">
                    <option value="">Select status...</option>
                    <option value="energised">⚡ ENERGISED</option>
                    <option value="isolated">🔒 ISOLATED</option>
                </select>
            </div>
            <div class="form-group">
                <label class="required">Access</label>
                <select id="access" required onchange="markUnsaved()">
                    <option value="">Select access method...</option>
                    <option value="ground">From ground level</option>
                    <option value="scaffold">Scaffold</option>
                    <option value="ewp">Elevated Work Platform (EWP)</option>
                    <option value="ladder">Ladder</option>
                </select>
            </div>
            <div class="form-group">
                <label class="required">Inspection Date</label>
                <input type="date" id="date" oninput="markUnsaved()" required>
            </div>
            <div class="form-group">
                <label>Ambient Temperature (°C)</label>
                <input type="number" id="ambientTemp" placeholder="e.g., 25" min="-5" max="50" step="0.5" value="20" oninput="markUnsaved()">
            </div>
            <div class="form-group">
                <label>Top oil temperature (°C)</label>
                <input type="text" id="transformerTemp" placeholder="e.g., 65 or As ambient" value="As ambient" oninput="markUnsaved()">
            </div>
            <div class="form-group">
                <label>Weather Conditions</label>
                <select id="weatherConditions" onchange="toggleWeatherConditionsOther(); markUnsaved()">
                    <option value="">Select weather conditions...</option>
                    <option value="clear">☀️ Clear/Sunny</option>
                    <option value="partly-cloudy">⛅ Partly Cloudy</option>
                    <option value="overcast">☁️ Overcast</option>
                    <option value="light-rain">🌦️ Light Rain</option>
                    <option value="heavy-rain">🌧️ Heavy Rain</option>
                    <option value="fog">🌫️ Fog/Mist</option>
                    <option value="snow">❄️ Snow</option>
                    <option value="wind">💨 Windy</option>
                    <option value="storm">⛈️ Storm</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group" id="weatherConditionsOtherGroup" style="display: none;">
                <label>Weather Details</label>
                <input type="text" id="weatherConditionsOther" placeholder="Enter weather conditions..." maxlength="75" oninput="updateWordCount('weatherConditionsOther', 'weatherConditionsOtherCounter', 75); markUnsaved()">
                <div class="word-counter" id="weatherConditionsOtherCounter">0/75 characters</div>
            </div>
            <div class="form-group" style="grid-column: span 2;">
                <label>Inspection Standard</label>
                <select id="inspectionStandard" onchange="toggleInspectionStandardOther(); markUnsaved()">
                    <option value="">Select standard...</option>
                    <option value="IEC 60076, Power transformers">IEC 60076, Power transformers</option>
                    <option value="IEEE Std C57.12.00, General requirements for liquid immersed transformers">IEEE Std C57.12.00, General requirements for liquid immersed transformers</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="form-group" id="inspectionStandardOtherGroup" style="display: none; grid-column: span 2;">
                <label>Standard Details</label>
                <input type="text" id="inspectionStandardOther" placeholder="Enter standard details..." maxlength="75" oninput="updateWordCount('inspectionStandardOther', 'inspectionStandardOtherCounter', 75); markUnsaved()">
                <div class="word-counter" id="inspectionStandardOtherCounter">0/75 characters</div>
            </div>
        </div>
        
        <!-- N/A Sections Summary (Print Only) -->
        <div id="naSummary" class="na-summary" style="display: none;">
            <h3>⚠️ Sections Marked as Not Applicable (N/A)</h3>
            <div id="naSummaryList"></div>
        </div>
        
        
<div class="photo-gallery" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; page-break-after: always;">
    <div class="photo-item"><img src="images/photo1.jpg" alt="Inspection Photo 1" style="width:100%; border-radius:8px;"></div>
    <div class="photo-item"><img src="images/photo2.jpg" alt="Inspection Photo 2" style="width:100%; border-radius:8px;"></div>
    <div class="photo-item"><img src="images/photo3.jpg" alt="Inspection Photo 3" style="width:100%; border-radius:8px;"></div>
    <div class="photo-item"><img src="images/photo4.jpg" alt="Inspection Photo 4" style="width:100%; border-radius:8px;"></div>
</div>

        </div>
    </div>

    <div class="section">
        <h2>Inspection Progress - <span id="itemsInspectedText">0</span> items inspected</h2>
        <div class="stats-grid">
            <div class="stat-card" style="background:#C6EFCE;">
                <div class="stat-value" id="passCount">0</div>
                <div class="stat-label">✓ Passed</div>
            </div>
            <div class="stat-card" style="background:#FFD966;">
                <div class="stat-value" id="warnCount">0</div>
                <div class="stat-label">⚠ Warning</div>
            </div>
            <div class="stat-card" style="background:#FFC7CE;">
                <div class="stat-value" id="failCount">0</div>
                <div class="stat-label">✗ Failed</div>
            </div>
            <div class="stat-card" style="background:#D9D9D9;">
                <div class="stat-value" id="skipCount">0</div>
                <div class="stat-label">○ Skipped</div>
            </div>
            <div class="stat-card" style="background:#2563eb; color:#fff;">
                <div class="stat-value" id="naCount" style="color:#fff;">0</div>
                <div class="stat-label" style="color:#fff;">🚫 N/A</div>
            </div>
            <div class="stat-card" style="background:#e0e7ff;">
                <div class="stat-value" id="completionPct">0%</div>
                <div class="stat-label">Complete</div>
            </div>
            <div class="stat-card" style="background:#fef3c7;">
                <div class="stat-value" id="photoCount">0</div>
                <div class="stat-label">📷 Photos</div>
            </div>
        </div>
    </div>

    <div class="section" id="checklistSection">
        <div class="checklist-header-wrapper" id="checklistHeader">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:0.75rem; flex-wrap:wrap;">
                <div style="display:flex; align-items:center; gap:1.5rem; flex-wrap:wrap;">
                    <h2>Inspection Checklist</h2>
                    <div class="status-legend">
                        <div class="legend-item">
                            <div class="legend-icon pass">✓</div>
                            <span>OK</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-icon warning">⚠</div>
                            <span>Warning</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-icon fail">✗</div>
                            <span>Fail</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-icon skip">○</div>
                            <span>Skip</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-icon na">🚫</div>
                            <span>N/A</span>
                        </div>
                    </div>
                </div>
                <button id="toggleAllBtn" class="btn btn-blue" onclick="toggleAllSections()">▶️ Collapse All</button>
            </div>
        </div>
        <div id="sections"></div>
    </div>

    <div class="section" id="comments-section" style="border:none;">
        <h2>Comments / Recommendations</h2>
        <div class="textarea-wrapper">
            <textarea id="comments" rows="6" maxlength="2000" style="width:100%; padding:0.75rem; border:1px solid #d1d5db; border-radius:0.375rem;" 
                placeholder="Enter any additional observations, recommendations, or follow-up actions..." oninput="markUnsaved(); updateWordCount('comments', 'commentsCounter', 2000)"></textarea>
            <div class="word-counter" id="commentsCounter" style="margin-top: 0.5rem;">0/2000 characters</div>
        </div>
    </div>

    <div class="section" id="signatures-section">
        <div style="background: #005DAA; color: white; padding: 1rem 1.5rem; border-radius: 0.375rem; margin-bottom: 1.5rem;">
            <h2 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 0;">Inspection Disclaimer and Limitations</h2>
        </div>
        
        <div id="disclaimer-text" style="margin-bottom: 1.5rem; font-size: 0.875rem; line-height: 1.6;">
            <p style="margin-bottom: 0.75rem;">This visual inspection report represents observations made at the specific date and time documented herein. The findings are based solely on visual assessment of accessible components and do not include electrical testing, oil analysis, or internal examination unless explicitly stated.</p>
            
            <p style="margin-bottom: 0.75rem;">This report does not constitute a warranty, guarantee, or certification of the transformer's condition, safety, operational reliability, or fitness for continued service. The inspection is limited to externally visible components and conditions at the time of inspection and may not identify latent defects, internal deterioration, or issues not readily apparent through visual examination.</p>
            
            <p style="margin-bottom: 0.75rem;"><strong>The inspector assumes no liability for:</strong></p>
            <ul style="margin-left: 1.5rem; margin-bottom: 0.75rem;">
                <li>Conditions that were concealed, inaccessible, or not readily visible during inspection</li>
                <li>Subsequent deterioration or failures occurring after the inspection date</li>
                <li>Accuracy of nameplate data, manufacturer specifications, or third-party provided information</li>
                <li>Consequences of decisions made based on this report</li>
            </ul>
            
            <p style="margin-bottom: 0.75rem;">This report is intended for the exclusive use of the client/asset owner and should not be relied upon by third parties without written consent. Comprehensive diagnostic testing, including oil analysis and electrical tests as recommended by Doble Engineering are further advised to fully assess the transformer condition and remaining service life.</p>
            
            <p style="margin-bottom: 0;">The client acknowledges that visual inspection has inherent limitations and that this report should be considered alongside other condition assessment methods when making operational or maintenance decisions.</p>
        </div>
        
        <div style="background: #005DAA; color: white; padding: 1rem 1.5rem; border-radius: 0.375rem; margin-bottom: 1rem;">
            <h2 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 0;">Signatures</h2>
        </div>
        <div class="signature-grid">
            <div class="signature-box">
                <h3>Inspector Signature</h3>
                <div style="margin-bottom:0.75rem; position: relative;">
                    <canvas class="sig-canvas" id="inspectorSig" width="400" height="120"></canvas>
                    <div id="inspectorAcceptedOverlay" style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(76, 175, 80, 0.1); border: 2px solid #4caf50; border-radius: 0.375rem; pointer-events: none;">
                        <span style="position: absolute; bottom: 8px; right: 8px; background: #4caf50; color: white; padding: 0.375rem 0.75rem; border-radius: 0.375rem; font-weight: 600; font-size: 0.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">✓ Accepted</span>
                    </div>
                </div>
                <div class="form-group" style="margin-bottom:0.75rem;">
                    <label>Date</label>
                    <input type="date" id="inspectorDate" oninput="markUnsaved()">
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    <button class="btn btn-green" id="inspectorAcceptBtn" onclick="acceptSignature('inspector')" style="flex: 1;">✓ Accept</button>
                    <button class="btn btn-orange" id="inspectorRedoBtn" onclick="redoSignature('inspector')" style="flex: 1;" disabled>↺ Redo</button>
                </div>
            </div>
            <div class="signature-box">
                <h3>Supervisor Signature</h3>
                <div style="margin-bottom:0.75rem; position: relative;">
                    <canvas class="sig-canvas" id="supervisorSig" width="400" height="120"></canvas>
                    <div id="supervisorAcceptedOverlay" style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(76, 175, 80, 0.1); border: 2px solid #4caf50; border-radius: 0.375rem; pointer-events: none;">
                        <span style="position: absolute; bottom: 8px; right: 8px; background: #4caf50; color: white; padding: 0.375rem 0.75rem; border-radius: 0.375rem; font-weight: 600; font-size: 0.75rem; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">✓ Accepted</span>
                    </div>
                </div>
                <div class="form-group" style="margin-bottom:0.75rem;">
                    <label>Date</label>
                    <input type="date" id="supervisorDate" oninput="markUnsaved()">
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    <button class="btn btn-green" id="supervisorAcceptBtn" onclick="acceptSignature('supervisor')" style="flex: 1;">✓ Accept</button>
                    <button class="btn btn-orange" id="supervisorRedoBtn" onclick="redoSignature('supervisor')" style="flex: 1;" disabled>↺ Redo</button>
                </div>
            </div>
        </div>
    </div>

    <div class="section" style="border:none; padding-top: 2rem; padding-bottom: 2rem;">
        <h2 style="text-align: center; margin-bottom: 1.5rem;">Save & Export Options</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; max-width: 1200px; margin: 0 auto;">
            <button class="btn btn-green" onclick="saveDataToJSON()" style="padding: 1rem; font-size: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                <span style="font-size: 2rem;">💾</span>
                <span style="font-weight: bold;">Save Data (JSON)</span>
                <span style="font-size: 0.75rem; opacity: 0.9;">Download as Inspection_[Location]_[ID]_[Date].json</span>
            </button>
            <button class="btn btn-blue" onclick="validateAndExport()" style="padding: 1rem; font-size: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                <span style="font-size: 2rem;">📊</span>
                <span style="font-weight: bold;">Export to Excel</span>
                <span style="font-size: 0.75rem; opacity: 0.9;">Generate complete inspection report</span>
            </button>
            <button class="btn btn-purple" onclick="exportPhotoDatabase()" style="padding: 1rem; font-size: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                <span style="font-size: 2rem;">📷</span>
                <span style="font-weight: bold;">Export Photo List</span>
                <span style="font-size: 0.75rem; opacity: 0.9;">Download photo inventory as CSV</span>
            </button>
            <button class="btn btn-orange" onclick="printPhotoList()" style="padding: 1rem; font-size: 1rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                <span style="font-size: 2rem;">🖨️</span>
                <span style="font-weight: bold;">Print Photo List</span>
                <span style="font-size: 0.75rem; opacity: 0.9;">Generate printable photo inventory</span>
            </button>
        </div>
    </div>

<div style="text-align:center; padding: 1.5rem; background: #f9fafb; border-top: 2px solid #e5e7eb; margin-top: 2rem;">
    <div style="font-size:0.9rem; font-weight:600; color:#374151; margin-bottom: 0.5rem;">
        Power Transformer Inspection Form v0.77
    </div>
    <div style="font-size:0.8rem; color:#6b7280; margin-bottom: 0.75rem;">
        Digital inspection checklist with photo documentation and GPS location
    </div>
    <div style="font-size:0.75rem; color:#9ca3af; margin-top: 0.75rem;">
        Last updated: <span id="lastModified">2025-10-26</span>
    </div>
</div>

<div class="photo-viewer" id="photoViewer">
    <div class="photo-viewer-controls">
        <button class="photo-viewer-btn" onclick="rotatePhoto(-90)" title="Rotate Left">↺</button>
        <button class="photo-viewer-btn" onclick="rotatePhoto(90)" title="Rotate Right">↻</button>
        <button class="photo-viewer-btn" onclick="resetPhotoRotation()" title="Reset Rotation">⟲</button>
        <button class="photo-viewer-btn" onclick="zoomPhoto(1.2)" title="Zoom In">+</button>
        <button class="photo-viewer-btn" onclick="zoomPhoto(0.8)" title="Zoom Out">−</button>
        <button class="photo-viewer-btn" onclick="resetPhotoZoom()" title="Reset Zoom">⊙</button>
        <button class="photo-viewer-btn" onclick="toggleAnnotation()" title="Add Note">✏️</button>
        <button class="photo-viewer-btn" onclick="downloadCurrentPhoto()" title="Download">⬇</button>
        <button class="photo-viewer-btn" onclick="closePhotoViewer()" title="Close">✕</button>
    </div>
    <button class="photo-viewer-nav prev photo-viewer-btn" onclick="navigatePhoto(-1)" id="prevPhotoBtn">‹</button>
    <button class="photo-viewer-nav next photo-viewer-btn" onclick="navigatePhoto(1)" id="nextPhotoBtn">›</button>
    <div class="photo-viewer-content">
        <img id="viewerImage" src="" alt="Photo">
    </div>
    <div class="photo-viewer-info" id="photoViewerInfo">Photo 1 of 1</div>
    <div class="photo-annotation" id="photoAnnotationPanel">
        <h3>📝 Photo Annotation</h3>
        <textarea id="annotationText" placeholder="Add notes, observations, or details about this photo..."></textarea>
        <div class="button-group">
            <button class="save-btn" onclick="saveAnnotation()">Save Note</button>
            <button class="cancel-btn" onclick="toggleAnnotation()">Cancel</button>
        </div>
    </div>
</div>

<div class="validation-modal" id="validationModal">
    <div class="validation-content">
        <h2>🔍 Pre-Export Validation</h2>
        <div id="validationResults"></div>
        <div class="validation-buttons">
            <button class="cancel-btn" onclick="closeValidation()">Review Form</button>
            <button class="proceed-btn" id="proceedExportBtn" onclick="proceedWithExport()">Proceed to Export</button>
        </div>
    </div>
</div>

<div class="validation-modal" id="filenameModal">
    <div class="validation-content" style="max-width: 600px;">
        <h2>💾 Save Inspection Report</h2>
        <div style="margin: 1.5rem 0;">
            <div style="margin-bottom: 1rem;">
                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Filename:</label>
                <input type="text" id="exportFilename" style="width: 100%; padding: 0.75rem; border: 2px solid #d1d5db; border-radius: 0.5rem; font-size: 1rem; font-family: 'Courier New', monospace;" placeholder="Enter filename...">
                <div style="margin-top: 0.5rem; font-size: 0.875rem; color: #6b7280;">
                    <strong>Format:</strong> Excel Workbook (.xlsx)
                </div>
            </div>
            <div style="background: #f3f4f6; padding: 1rem; border-radius: 0.5rem; margin-top: 1rem;">
                <div style="font-size: 0.875rem; color: #374151; margin-bottom: 0.5rem;"><strong>📊 Export Summary:</strong></div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.875rem;">
                    <div><strong>Transformer ID:</strong> <span id="exportSummaryId">-</span></div>
                    <div><strong>Date:</strong> <span id="exportSummaryDate">-</span></div>
                    <div><strong>Inspector:</strong> <span id="exportSummaryInspector">-</span></div>
                    <div><strong>Location:</strong> <span id="exportSummaryLocation">-</span></div>
                    <div><strong>Total Photos:</strong> <span id="exportSummaryPhotos">0</span></div>
                    <div><strong>Completion:</strong> <span id="exportSummaryCompletion">0%</span></div>
                </div>
            </div>
            <div style="margin-top: 1rem; padding: 0.75rem; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 0.375rem; font-size: 0.875rem;">
                <strong>💡 Tip:</strong> The file will be saved to your browser's default download location. You can change this in your browser settings.
            </div>
        </div>
        <div class="validation-buttons">
            <button class="cancel-btn" onclick="closeFilenameModal()">Cancel</button>
            <button class="proceed-btn" onclick="confirmExport()">💾 Save File</button>
        </div>
    </div>
</div>

<div class="validation-modal" id="jsonFilenameModal">
    <div class="validation-content" style="max-width: 600px;">
        <h2>💾 Save Inspection Data (JSON)</h2>
        <div style="margin: 1.5rem 0;">
            <div style="margin-bottom: 1rem;">
                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Filename:</label>
                <input type="text" id="jsonFilename" style="width: 100%; padding: 0.75rem; border: 2px solid #d1d5db; border-radius: 0.5rem; font-size: 1rem; font-family: 'Courier New', monospace;" placeholder="Enter filename...">
                <div style="margin-top: 0.5rem; font-size: 0.875rem; color: #6b7280;">
                    <strong>Format:</strong> JSON Data File (.json)
                </div>
            </div>
            <div style="background: #f3f4f6; padding: 1rem; border-radius: 0.5rem; margin-top: 1rem;">
                <div style="font-size: 0.875rem; color: #374151; margin-bottom: 0.5rem;"><strong>📋 Data Summary:</strong></div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.875rem;">
                    <div><strong>Transformer ID:</strong> <span id="jsonSummaryId">-</span></div>
                    <div><strong>Date:</strong> <span id="jsonSummaryDate">-</span></div>
                    <div><strong>Location:</strong> <span id="jsonSummaryLocation">-</span></div>
                    <div><strong>Total Photos:</strong> <span id="jsonSummaryPhotos">0</span></div>
                </div>
            </div>
            <div style="margin-top: 1rem; padding: 0.75rem; background: #dbeafe; border-left: 4px solid #3b82f6; border-radius: 0.375rem; font-size: 0.875rem;">
                <strong>ℹ️ Note:</strong> JSON format preserves all data including photos (as base64) and can be loaded back into this form.
            </div>
        </div>
        <div class="validation-buttons">
            <button class="cancel-btn" onclick="closeJsonFilenameModal()">Cancel</button>
            <button class="proceed-btn" onclick="confirmJsonExport()">💾 Save JSON</button>
        </div>
    </div>
</div>

<div class="validation-modal" id="photoDbModal">
    <div class="validation-content" style="max-width: 800px;">
        <h2>📷 Photo Database</h2>
        <div id="photoDbContent" class="photo-database-list"></div>
        <div class="validation-buttons">
            <button class="proceed-btn" onclick="exportPhotoDatabase()">Export List</button>
            <button class="cancel-btn" onclick="closePhotoDatabase()">Close</button>
        </div>
    </div>
</div>

<div class="validation-modal" id="executiveSummaryModal">
    <div class="validation-content" style="max-width: 900px;">
        <h2>📋 Executive Summary Report</h2>
        <div id="executiveSummaryContent" style="background: white; padding: 2rem; border-radius: 0.5rem; max-height: 70vh; overflow-y: auto;"></div>
        <div class="validation-buttons">
            <button class="proceed-btn" onclick="printExecutiveSummary()">🖨️ Print</button>
            <button class="cancel-btn" onclick="closeExecutiveSummary()">Close</button>
        </div>
    </div>
</div>

<div class="network-status" id="networkStatus">
    <span id="networkText">Offline - Data saved locally</span>
</div>

<div class="storage-warning" id="storageWarning">
    <h3>⚠️ Storage Space Low</h3>
    <p id="storageMessage">Your browser storage is running low. Consider exporting data to free up space.</p>
    <div class="storage-meter">
        <div class="storage-meter-fill" id="storageMeterFill"></div>
    </div>
    <div class="button-group">
        <button class="btn-primary" onclick="handleStorageAction()">Manage Storage</button>
        <button class="btn-secondary" onclick="dismissStorageWarning()">Dismiss</button>
    </div>
</div>

<div class="alert" id="errorAlert"></div>
<div class="success-alert" id="successAlert"></div>
<div class="spinner" id="spinner">
    <div style="font-weight:600; color:#1f2937;">Processing...</div>
</div>

<script>
const CONFIG = {
    AUTO_SAVE_KEY: 'transformer_inspection_v0.77',
    AUTO_SAVE_INTERVAL: 30000,
    STORAGE_WARNING_THRESHOLD: 0.8,
    STORAGE_CRITICAL_THRESHOLD: 0.95,
    MAX_PHOTO_SIZE: 10 * 1024 * 1024,
    NETWORK_CHECK_INTERVAL: 10000,
    IMAGE_QUALITY: 0.88,  // Optimized for visual quality vs file size
    MAX_IMAGE_DIMENSION: 1920,  // Reduced from 4096 for better performance
    TARGET_FILE_SIZE: 400 * 1024,  // Target 400KB after compression (allows 10-12 photos)
    MIN_QUALITY: 0.65,  // Don't go below this quality
    MAX_QUALITY: 0.92,  // Start with high quality
    
    // GitHub Integration - UPDATE THESE WITH YOUR DETAILS
    GITHUB_USERNAME: 'denisnesbitt',  // Replace with your GitHub username
    GITHUB_REPO: 'transformer-inspection',  // Replace with your repo name
    VERSION: '0.77',
    LAST_UPDATED: '2025-10-26'
};

// Doble Engineering Company Logo (base64 encoded WebP)
const LOGO_BASE64 = document.querySelector('.header-logo')?.src || '';

const sections = {
    found: {
        t: 'Foundation & Pen',
        c: '#005DAA',
        items: [
            'State of foundation and drainage',
            'Ground level and free of weeds, rubbish or debris',
            'Note any trip/bump hazards, are they clearly defined and protected?',
            'Compound fencing, security, locks in place',
            'Overgrown vegetation cleared',
            'Evidence of wildlife or nesting birds',
            'Bird/pest deterrents present',
            'Warning signage present and legible',
            'Fire suppression system access clear',
            'Oil containment bund condition',
            'Bund drainage clear',
            'Emergency access route clear'
        ]
    },
    tank: {
        t: 'Main Tank',
        c: '#005DAA',
        items: [
            'External corrosion and appearance',
            'Physical damage/dents',
            'Oil leaks - body, welded joints, valve glands',
            'Gasket condition at covers',
            'Earthing connections tight and grounding braid intact',
            'Overall cleanliness'
        ]
    },
    cons: {
        t: 'Conservator & Breather',
        c: '#005DAA',
        items: [
            'External corrosion and appearance',
            'Oil level normal',
            'S.G. good or spent, oil seal good?, water ingress?',
            'Connections tight',
            'Air vent caps present',
            'Drain valve accessible'
        ]
    },
    cool: {
        t: 'Cooling System',
        c: '#005DAA',
        items: [
            'Radiator condition, rust, leaks, damaged etc',
            'Free of obstructions likely to hinder cooling performance',
            'Inlet and outlet valves',
            'Fan condition',
            'Fan mounting and connections',
            'Fan noise normal',
            'Pump condition, rust, leaks, damaged, etc',
            'Pump operation'
        ]
    },
    buch: {
        t: 'Gas/Oil Relay (Buchholz)',
        c: '#005DAA',
        items: [
            'External condition, corrosion, incl. pipework and valves',
            'Oil level in sight glass',
            'Test cocks operational',
            'Mounting secure',
            'A/T contacts wired',
            'Pipework gradient correct (1-4%)'
        ]
    },
    temp: {
        t: 'Temperature Indicators',
        c: '#005DAA',
        items: [
            'OTI condition and readable',
            'OTI oil in pocket and sensor secure',
            'OTI alarm and trip test',
            'OTI reading',
            'WTI condition and readable',
            'WTI CT secure',
            'WTI alarm and trip test',
            'WTI reading'
        ]
    },
    
    
    
    
    
    pressure: {
        t: 'Pressure Gages',
        c: '#005DAA',
        items: [
            'Is inert gas bottle gauge legible?',
            'Gas bottle inert gas pressure gauge reading',
            'Overall condition of gauge',
            'Is system pressure gauge legible?',
            'System pressure reading',
            'Overall condition of system pressure gauge'
        ]
    },




prd: {
        t: 'Main Tank PRD',
        c: '#005DAA',
        items: [
            'PRD condition',
            'Mounting secure',
            'Vent clear',
            'Indicator reset',
            'SPR condition',
            'SPR contacts tested',
            'Deflector secure'
        ]
    },
    oil: {
        t: 'Oil Level & Condition',
        c: '#005DAA',
        items: [
            'Main tank/conservator level gauge readable',
            'LTC level gauge readable',
            'Level(s) Normal',
            'Oil appearance, colour, clarity, presence of sludge or moisture',
            'OLTC oil level',
            'HV and LV bushing levels Normal'
        ]
    },
    hvbush: {
        t: 'HV Bushings',
        c: '#005DAA',
        items: [
            'Condition, cracks, evidence of tracking or corona etc',
            'Clean and dry',
            'Terminals tight',
            'No overheating',
            'Clamps secure',
            'Grading rings',
            'CT taps accessible',
            'No gasket leaks'
        ]
    },
    lvbush: {
        t: 'LV Bushings',
        c: '#005DAA',
        items: [
            'Condition, cracks, evidence of tracking or corona etc',
            'Clean and dry',
            'Terminals tight',
            'No overheating',
            'Clamps secure',
            'Neutral earthing',
            'CT taps accessible',
            'No gasket leaks'
        ]
    },
    tvbush: {
        t: 'TV Bushings',
        c: '#005DAA',
        items: [
            'Condition, cracks, evidence of tracking or corona etc',
            'Clean and dry',
            'Terminals tight',
            'No overheating',
            'Clamps secure',
            '3 phase out or open delta',
            'One end earthed',
            'No gasket leaks'
        ]
    },
    tap: {
        t: 'LTC (On-Load Tap Changer)',
        c: '#005DAA',
        items: [
            'Manufacturer and model number',
            'Condition, paint, rust, leaks etc',
            'No gasket leaks',
            'Position legible, recorded',
            'Drive mechanism',
            'Motor operation',
            'Local/remote selector',
            'Counter reading',
            'Control wiring',
            'Limit switches',
            'Oil surge relay condition',
            'PRD condition'
        ]
    },
    detc: {
        t: 'DETC (De-Energised Tap Changer)',
        c: '#005DAA',
        items: [
            'Manufacturer and model number',
            'External condition',
            'No gasket leaks',
            'Position readable',
            'Position recorded',
            'Padlock present',
            'Drive mechanism',
            'Control wiring',
            'Handle/wheel operation'
        ]
    },
    elec: {
        t: 'Electrical Connections',
        c: '#005DAA',
        items: [
            'HV terminations, boxes sealed, glands intact',
            'LV terminations, boxes sealed, glands intact',
            'TV terminations, box sealed, glands intact',
            'Neutral earthing',
            'Main earthing intact',
            'CT wiring',
            'Bonding complete'
        ]
    },
    surge: {
        t: 'Surge Arresters',
        c: '#005DAA',
        items: [
            'HV arrester condition',
            'HV counter reading',
            'LV arrester condition',
            'LV counter reading',
            'Neutral arrester',
            'Neutral counter reading',
            'Mounting secure',
            'Earth connections'
        ]
    },
    marsh: {
        t: 'Marshalling & Auxiliary',
        c: '#005DAA',
        items: [
            'Box condition',
            'Door seal',
            'Is there power to the marshalling/control panel',
            'Wiring diagram and related documents in document holder',
            'Anticondensation measures in place',
            'Wiring labeled',
            'Cable entries sealed',
            'Covers secure',
            'CT/PT blocks',
            'Wiring appears undisturbed'
        ]
    }
};

const opts = [
    {v:'pass', l:'✓ OK', icon:'✓'},
    {v:'warning', l:'⚠ Warning', icon:'⚠'},
    {v:'fail', l:'✗ Fail', icon:'✗'},
    {v:'skip', l:'○ Skip', icon:'○'},
    {v:'na', l:'🚫 N/A', icon:'🚫'}
];

let hasUnsavedChanges = false;
let autoSaveTimer = null;
let photos = {
    info: {
        RatingPlate: null,
        View1: null,
        View2: null
    },
    lines: {}
};
let photoDatabase = [];
let currentPhotoIndex = 0;
let currentPhotoRotation = 0;
let currentPhotoZoom = 1;
let isDragging = false;
let dragStart = {x: 0, y: 0};
let photoTranslate = {x: 0, y: 0};
let networkCheckTimer = null;
let storageCheckTimer = null;
let connectionQuality = 'unknown';
let allPhotos = [];
let currentViewingPhoto = null;

// Signature acceptance state
let signatureState = {
    inspector: { accepted: false, canvasData: null },
    supervisor: { accepted: false, canvasData: null }
};

function sanitize(str) {
    const div = document.createElement('div');
    div.textContent = str;
    return div.innerHTML;
}

function generateFilename(lineNumber = null, photoType = null) {
    const location = document.getElementById('location').value.replace(/[^a-zA-Z0-9]/g, '_') || 'Unknown';
    const transformerId = document.getElementById('transformerId').value.replace(/[^a-zA-Z0-9]/g, '_') || 'Unknown';
    const now = new Date();
    const date = now.toISOString().split('T')[0];
    const time = now.toTimeString().split(' ')[0].replace(/:/g, '-');
    
    if (photoType) {
        return `${location}_${transformerId}_${date}_${time}_${photoType}`;
    } else if (lineNumber !== null) {
        return `${location}_${transformerId}_${date}_${time}_Line${lineNumber}`;
    }
    return `${location}_${transformerId}_${date}_${time}`;
}

function addToPhotoDatabase(filename, data, lineNumber, photoType, annotation = '') {
    const entry = {
        id: Date.now() + Math.random(),
        filename: filename,
        timestamp: new Date().toISOString(),
        lineNumber: lineNumber,
        photoType: photoType,
        fileSize: Math.round(data.length * 0.75),
        annotation: annotation,
        data: data
    };
    photoDatabase.push(entry);
    return entry;
}

function getGPSLocation() {
    // Check if running in secure context
    if (window.location.protocol === 'file:') {
        showAlert('GPS requires HTTPS or localhost. Please use a web server or local server to access GPS.', 'error');
        return;
    }
    
    if (!navigator.geolocation) {
        showAlert('Geolocation not supported by your browser', 'error');
        return;
    }
    
    showSpinner();
    
    navigator.geolocation.getCurrentPosition(
        (position) => {
            const lat = position.coords.latitude.toFixed(6);
            const lon = position.coords.longitude.toFixed(6);
            document.getElementById('gpsCoordinates').value = `${lat}, ${lon}`;
            hideSpinner();
            showAlert('GPS location obtained successfully', 'success');
            markUnsaved();
        },
        (error) => {
            hideSpinner();
            let errorMsg = 'Unable to get GPS location';
            if (error.code === 1) {
                errorMsg = 'GPS permission denied. Please allow location access in your browser settings.';
            } else if (error.code === 2) {
                errorMsg = 'GPS position unavailable. Please check your device location services.';
            } else if (error.code === 3) {
                errorMsg = 'GPS request timed out. Please try again.';
            }
            showAlert(errorMsg, 'error');
        },
        { timeout: 15000, enableHighAccuracy: true, maximumAge: 0 }
    );
}

function markUnsaved() {
    hasUnsavedChanges = true;
    updateAutoSaveStatus('unsaved');
}

function updateAutoSaveStatus(status) {
    const indicator = document.getElementById('autoSaveStatus');
    indicator.className = 'auto-save-indicator';
    
    if (status === 'saved') {
        indicator.textContent = '✓ Saved';
        indicator.classList.add('saved');
    } else if (status === 'saving') {
        indicator.textContent = '⏳ Saving...';
        indicator.classList.add('saving');
    } else if (status === 'error') {
        indicator.textContent = '⚠ Error';
        indicator.classList.add('error');
    } else {
        indicator.textContent = '● Unsaved';
        indicator.classList.add('saving');
    }
}

function toggleInspectionStandardOther() {
    const standard = document.getElementById('inspectionStandard').value;
    const otherGroup = document.getElementById('inspectionStandardOtherGroup');
    
    if (standard === 'Other') {
        otherGroup.style.display = 'flex';
    } else {
        otherGroup.style.display = 'none';
        document.getElementById('inspectionStandardOther').value = '';
    }
}

function toggleWeatherConditionsOther() {
    const weather = document.getElementById('weatherConditions').value;
    const otherGroup = document.getElementById('weatherConditionsOtherGroup');
    
    if (weather === 'Other') {
        otherGroup.style.display = 'flex';
    } else {
        otherGroup.style.display = 'none';
        document.getElementById('weatherConditionsOther').value = '';
        document.getElementById('weatherConditionsOtherCounter').textContent = '0/75 characters';
    }
}

// Smart adaptive image compression targeting ~800KB file size
async function processImage(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = (e) => {
            const img = new Image();
            img.onload = () => {
                const canvas = document.createElement('canvas');
                let width = img.width;
                let height = img.height;
                
                // Resize to max dimension while maintaining aspect ratio
                if (width > CONFIG.MAX_IMAGE_DIMENSION || height > CONFIG.MAX_IMAGE_DIMENSION) {
                    if (width > height) {
                        height = (height / width) * CONFIG.MAX_IMAGE_DIMENSION;
                        width = CONFIG.MAX_IMAGE_DIMENSION;
                    } else {
                        width = (width / height) * CONFIG.MAX_IMAGE_DIMENSION;
                        height = CONFIG.MAX_IMAGE_DIMENSION;
                    }
                }
                
                canvas.width = width;
                canvas.height = height;
                
                const ctx = canvas.getContext('2d');
                // Use higher quality rendering for better results
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                ctx.drawImage(img, 0, 0, width, height);
                
                // Adaptive compression to hit target file size
                let quality = CONFIG.MAX_QUALITY;
                let dataUrl = canvas.toDataURL('image/jpeg', quality);
                let currentSize = Math.round(dataUrl.length * 0.75); // Estimate actual file size
                
                // If image is already under target, return it
                if (currentSize <= CONFIG.TARGET_FILE_SIZE) {
                    resolve(dataUrl);
                    return;
                }
                
                // Binary search for optimal quality to hit target size
                let minQuality = CONFIG.MIN_QUALITY;
                let maxQuality = CONFIG.MAX_QUALITY;
                let attempts = 0;
                const maxAttempts = 8; // Limit iterations
                
                while (attempts < maxAttempts && Math.abs(currentSize - CONFIG.TARGET_FILE_SIZE) > CONFIG.TARGET_FILE_SIZE * 0.1) {
                    if (currentSize > CONFIG.TARGET_FILE_SIZE) {
                        maxQuality = quality;
                    } else {
                        minQuality = quality;
                    }
                    
                    quality = (minQuality + maxQuality) / 2;
                    dataUrl = canvas.toDataURL('image/jpeg', quality);
                    currentSize = Math.round(dataUrl.length * 0.75);
                    attempts++;
                }
                
                // Final check: if still too large, use minimum quality
                if (currentSize > CONFIG.TARGET_FILE_SIZE * 1.3) {
                    dataUrl = canvas.toDataURL('image/jpeg', CONFIG.MIN_QUALITY);
                }
                
                resolve(dataUrl);
            };
            img.onerror = reject;
            img.src = e.target.result;
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
    });
}

async function handleInfoPhoto(event, photoType) {
    const file = event.target.files[0];
    if (!file) return;
    
    if (file.size > CONFIG.MAX_PHOTO_SIZE) {
        showAlert(`Photo exceeds ${CONFIG.MAX_PHOTO_SIZE / (1024 * 1024)}MB limit`, 'error');
        event.target.value = '';
        return;
    }
    
    try {
        showSpinner();
        const dataUrl = await processImage(file);
        const filename = generateFilename(null, photoType);
        
        photos.info[photoType] = {
            id: Date.now(),
            data: dataUrl,
            name: file.name,
            timestamp: new Date().toISOString(),
            annotation: '',
            rotation: 0,
            filename: filename
        };
        
        addToPhotoDatabase(filename, dataUrl, null, photoType);
        renderInfoPhotoThumb(photoType);
        updateStats();
        markUnsaved();
        hideSpinner();
        showAlert(`${photoType} photo captured`, 'success');
    } catch (err) {
        hideSpinner();
        showAlert(`Error processing photo: ${err.message}`, 'error');
    }
    
    event.target.value = '';
}

function renderInfoPhotoThumb(photoType) {
    const container = document.getElementById(`thumb${photoType}`);
    const photo = photos.info[photoType];
    
    if (!photo) {
        container.innerHTML = '';
        return;
    }
    
    container.innerHTML = `
        <div class="photo-thumb ${photo.annotation ? 'has-annotation' : ''}" onclick="openInfoPhoto('${photoType}')">
            <img src="${photo.data}" alt="${photoType}" style="transform: rotate(${photo.rotation || 0}deg);">
            <button class="delete-btn" onclick="event.stopPropagation(); deleteInfoPhoto('${photoType}')">×</button>
            <div class="photo-label">${photoType}</div>
            ${photo.annotation ? '<div class="annotation-indicator">📝</div>' : ''}
        </div>
    `;
}

function deleteInfoPhoto(photoType) {
    if (confirm(`Delete ${photoType} photo?`)) {
        const photo = photos.info[photoType];
        if (photo) {
            photoDatabase = photoDatabase.filter(p => p.filename !== photo.filename);
        }
        photos.info[photoType] = null;
        renderInfoPhotoThumb(photoType);
        updateStats();
        markUnsaved();
    }
}

function openInfoPhoto(photoType) {
    const photo = photos.info[photoType];
    if (!photo) return;
    
    allPhotos = [];
    ['RatingPlate', 'View1', 'View2'].forEach(type => {
        if (photos.info[type]) allPhotos.push({type: 'info', ref: type, photo: photos.info[type]});
    });
    
    for (let [sectionKey, section] of Object.entries(sections)) {
        section.items.forEach((item, i) => {
            const lineNum = getItemNumber(sectionKey, i);
            if (photos.lines[lineNum]) {
                photos.lines[lineNum].forEach(p => {
                    allPhotos.push({type: 'line', ref: lineNum, photo: p});
                });
            }
        });
    }
    
    currentPhotoIndex = allPhotos.findIndex(p => p.type === 'info' && p.ref === photoType);
    currentViewingPhoto = photo;
    currentPhotoRotation = photo.rotation || 0;
    currentPhotoZoom = 1;
    photoTranslate = {x: 0, y: 0};
    updatePhotoViewer();
    document.getElementById('photoViewer').classList.add('active');
    document.body.style.overflow = 'hidden';
}

async function handleLinePhoto(event, sectionKey, itemIndex) {
    const file = event.target.files[0];
    if (!file) return;
    
    if (file.size > CONFIG.MAX_PHOTO_SIZE) {
        showAlert(`Photo exceeds ${CONFIG.MAX_PHOTO_SIZE / (1024 * 1024)}MB limit`, 'error');
        event.target.value = '';
        return;
    }
    
    const lineNum = getItemNumber(sectionKey, itemIndex);
    
    try {
        showSpinner();
        const dataUrl = await processImage(file);
        const filename = generateFilename(lineNum);
        
        const photoObj = {
            id: Date.now() + Math.random(),
            data: dataUrl,
            name: file.name,
            timestamp: new Date().toISOString(),
            annotation: '',
            rotation: 0,
            filename: filename
        };
        
        if (!photos.lines[lineNum]) {
            photos.lines[lineNum] = [];
        }
        photos.lines[lineNum].push(photoObj);
        
        addToPhotoDatabase(filename, dataUrl, lineNum, 'LineItem');
        renderLinePhotos(sectionKey, itemIndex);
        updateStats();
        markUnsaved();
        hideSpinner();
        showAlert(`Photo added to Line ${lineNum}`, 'success');
    } catch (err) {
        hideSpinner();
        showAlert(`Error processing photo: ${err.message}`, 'error');
    }
    
    event.target.value = '';
}

function renderLinePhotos(sectionKey, itemIndex) {
    const lineNum = getItemNumber(sectionKey, itemIndex);
    const container = document.getElementById(`photos-${sectionKey}-${itemIndex}`);
    const linePhotos = photos.lines[lineNum] || [];
    
    container.innerHTML = linePhotos.map((photo, idx) => `
        <div class="photo-thumb ${photo.annotation ? 'has-annotation' : ''}" onclick="openLinePhoto('${sectionKey}', ${itemIndex}, ${idx})">
            <img src="${photo.data}" alt="Line ${lineNum}" style="transform: rotate(${photo.rotation || 0}deg);">
            <button class="delete-btn" onclick="event.stopPropagation(); deleteLinePhoto('${sectionKey}', ${itemIndex}, ${idx})">×</button>
            <div class="photo-label">L${lineNum}</div>
            ${photo.annotation ? '<div class="annotation-indicator">📝</div>' : ''}
        </div>
    `).join('');
}

function deleteLinePhoto(sectionKey, itemIndex, photoIndex) {
    const lineNum = getItemNumber(sectionKey, itemIndex);
    if (confirm('Delete this photo?')) {
        const photo = photos.lines[lineNum][photoIndex];
        if (photo) {
            photoDatabase = photoDatabase.filter(p => p.filename !== photo.filename);
        }
        photos.lines[lineNum].splice(photoIndex, 1);
        if (photos.lines[lineNum].length === 0) {
            delete photos.lines[lineNum];
        }
        renderLinePhotos(sectionKey, itemIndex);
        updateStats();
        markUnsaved();
    }
}

function openLinePhoto(sectionKey, itemIndex, photoIndex) {
    const lineNum = getItemNumber(sectionKey, itemIndex);
    const photo = photos.lines[lineNum][photoIndex];
    if (!photo) return;
    
    allPhotos = [];
    ['RatingPlate', 'View1', 'View2'].forEach(type => {
        if (photos.info[type]) allPhotos.push({type: 'info', ref: type, photo: photos.info[type]});
    });
    
    for (let [secKey, section] of Object.entries(sections)) {
        section.items.forEach((item, i) => {
            const ln = getItemNumber(secKey, i);
            if (photos.lines[ln]) {
                photos.lines[ln].forEach(p => {
                    allPhotos.push({type: 'line', ref: ln, photo: p});
                });
            }
        });
    }
    
    currentPhotoIndex = allPhotos.findIndex(p => 
        p.type === 'line' && p.ref === lineNum && p.photo.id === photo.id
    );
    currentViewingPhoto = photo;
    currentPhotoRotation = photo.rotation || 0;
    currentPhotoZoom = 1;
    photoTranslate = {x: 0, y: 0};
    updatePhotoViewer();
    document.getElementById('photoViewer').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function getFormData() {
    const data = {
        info: {
            transformerId: document.getElementById('transformerId').value,
            location: document.getElementById('location').value,
            gpsCoordinates: document.getElementById('gpsCoordinates').value,
            manufacturer: document.getElementById('manufacturer').value,
            serialNumber: document.getElementById('serialNumber').value,
            year: document.getElementById('year').value,
            rating: document.getElementById('rating').value,
            voltage: document.getElementById('voltage').value,
            coolingType: document.getElementById('coolingType').value,
            oilPreservationSystem: document.getElementById('oilPreservationSystem').value,
            status: document.getElementById('status').value,
            access: document.getElementById('access').value,
            date: document.getElementById('date').value,
            ambientTemp: document.getElementById('ambientTemp').value,
            transformerTemp: document.getElementById('transformerTemp').value,
            weatherConditions: document.getElementById('weatherConditions').value,
            weatherConditionsOther: document.getElementById('weatherConditionsOther').value,
            inspector: document.getElementById('inspector')?.value || '',
            inspectionStandard: document.getElementById('inspectionStandard').value,
            inspectionStandardOther: document.getElementById('inspectionStandardOther').value,
            inspectorDate: document.getElementById('inspectorDate').value,
            supervisorDate: document.getElementById('supervisorDate').value
        },
        sections: {},
        comments: document.getElementById('comments').value,
        photos: photos,
        photoDatabase: photoDatabase,
        signatureState: signatureState,
        timestamp: new Date().toISOString()
    };
    
    for (let [sectionKey, section] of Object.entries(sections)) {
        const naChecked = document.getElementById(`na-${sectionKey}`).checked;
        const sectionComment = document.getElementById(`section-comment-${sectionKey}`)?.value || '';
        data.sections[sectionKey] = {
            na: naChecked,
            sectionComment: sectionComment,
            items: []
        };
        
        section.items.forEach((item, i) => {
            const status = getItemStatus(sectionKey, i);
            const notes = document.getElementById(`nt-${sectionKey}-${i}`).value;
            data.sections[sectionKey].items.push({status, notes});
        });
    }
    
    return data;
}

function setFormData(data) {
    if (!data) return;
    
    if (data.info) {
        Object.keys(data.info).forEach(key => {
            const el = document.getElementById(key);
            if (el) el.value = data.info[key] || '';
        });
    }
    
    if (data.sections) {
        for (let [sectionKey, sectionData] of Object.entries(data.sections)) {
            if (sectionData.na) {
                document.getElementById(`na-${sectionKey}`).checked = true;
                toggleSectionNA(sectionKey);
            }
            
            // Restore section comment
            const sectionCommentEl = document.getElementById(`section-comment-${sectionKey}`);
            if (sectionCommentEl && sectionData.sectionComment) {
                sectionCommentEl.value = sectionData.sectionComment;
                updateWordCount(`section-comment-${sectionKey}`, `section-counter-${sectionKey}`, 700);
            }
            
            sectionData.items.forEach((itemData, i) => {
                if (itemData.status) setStatus(sectionKey, i, itemData.status);
                const notesEl = document.getElementById(`nt-${sectionKey}-${i}`);
                if (notesEl && itemData.notes) notesEl.value = itemData.notes;
            });
        }
    }
    
    if (data.comments) {
        document.getElementById('comments').value = data.comments;
    }
    
    if (data.photos) {
        photos = data.photos;
        ['RatingPlate', 'View1', 'View2'].forEach(type => {
            renderInfoPhotoThumb(type);
        });
        
        for (let [sectionKey, section] of Object.entries(sections)) {
            section.items.forEach((item, i) => {
                renderLinePhotos(sectionKey, i);
            });
        }
    }
    
    if (data.photoDatabase) {
        photoDatabase = data.photoDatabase;
    }
    
    // Restore signature state
    if (data.signatureState) {
        signatureState = data.signatureState;
        
        // Restore inspector signature
        if (signatureState.inspector.accepted && signatureState.inspector.canvasData) {
            const inspectorCanvas = document.getElementById('inspectorSig');
            const inspectorCtx = inspectorCanvas.getContext('2d');
            const img = new Image();
            img.onload = function() {
                // Clear canvas first
                inspectorCtx.clearRect(0, 0, inspectorCanvas.width, inspectorCanvas.height);
                // Draw image with canvas dimensions to prevent distortion
                inspectorCtx.drawImage(img, 0, 0, inspectorCanvas.width, inspectorCanvas.height);
            };
            img.src = signatureState.inspector.canvasData;
            
            document.getElementById('inspectorAcceptBtn').disabled = true;
            document.getElementById('inspectorRedoBtn').disabled = false;
            document.getElementById('inspectorAcceptedOverlay').style.display = 'flex';
            inspectorCanvas.style.cursor = 'not-allowed';
        }
        
        // Restore supervisor signature
        if (signatureState.supervisor.accepted && signatureState.supervisor.canvasData) {
            const supervisorCanvas = document.getElementById('supervisorSig');
            const supervisorCtx = supervisorCanvas.getContext('2d');
            const img = new Image();
            img.onload = function() {
                // Clear canvas first
                supervisorCtx.clearRect(0, 0, supervisorCanvas.width, supervisorCanvas.height);
                // Draw image with canvas dimensions to prevent distortion
                supervisorCtx.drawImage(img, 0, 0, supervisorCanvas.width, supervisorCanvas.height);
            };
            img.src = signatureState.supervisor.canvasData;
            
            document.getElementById('supervisorAcceptBtn').disabled = true;
            document.getElementById('supervisorRedoBtn').disabled = false;
            document.getElementById('supervisorAcceptedOverlay').style.display = 'flex';
            supervisorCanvas.style.cursor = 'not-allowed';
        }
    }
    
    // Toggle inspection standard "Other" text box if needed
    toggleInspectionStandardOther();
    
    updateStats();
    initializeAllWordCounters(); // Update all word counters after loading data
    hasUnsavedChanges = false;
    updateAutoSaveStatus('saved');
}

async function autoSave() {
    if (!hasUnsavedChanges) return;
    
    updateAutoSaveStatus('saving');
    
    try {
        const data = getFormData();
        localStorage.setItem(CONFIG.AUTO_SAVE_KEY, JSON.stringify(data));
        localStorage.setItem(CONFIG.AUTO_SAVE_KEY + '_timestamp', new Date().toISOString());
        hasUnsavedChanges = false;
        updateAutoSaveStatus('saved');
        checkStorageUsage();
    } catch (err) {
        updateAutoSaveStatus('error');
        if (err.name === 'QuotaExceededError') {
            showStorageWarning(true);
        }
    }
}

function loadAutoSave() {
    try {
        const saved = localStorage.getItem(CONFIG.AUTO_SAVE_KEY);
        if (!saved) {
            showAlert('No saved data found', 'info');
            return;
        }
        
        const timestamp = localStorage.getItem(CONFIG.AUTO_SAVE_KEY + '_timestamp');
        const data = JSON.parse(saved);
        
        if (confirm(`Load saved data from ${new Date(timestamp).toLocaleString()}?`)) {
            setFormData(data);
            showAlert('Data loaded successfully', 'success');
        }
    } catch (err) {
        showAlert('Error loading saved data: ' + err.message, 'error');
    }
}

function getItemNumber(section, index) {
    let num = 1;
    for (let [k, s] of Object.entries(sections)) {
        if (k === section) return num + index;
        num += s.items.length;
    }
    return num;
}

function setStatus(section, itemIndex, status) {
    const row = document.getElementById(`r-${section}-${itemIndex}`);
    const btns = document.getElementById(`status-${section}-${itemIndex}`);
    
    btns.querySelectorAll('.status-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.classList.contains(status)) {
            btn.classList.add('active');
        }
    });
    
    const colors = { pass: '#C6EFCE', warning: '#FFD966', fail: '#FFC7CE', skip: '#D9D9D9', na: '#e0e7ff'
    };
    
    row.style.background = colors[status] || '#D9D9D9';
    updateStats();
    updateSectionCompletion(section);
    markUnsaved();
}

function getItemStatus(section, itemIndex) {
    const btns = document.getElementById(`status-${section}-${itemIndex}`);
    const activeBtn = btns.querySelector('.status-btn.active');
    return activeBtn ? Array.from(activeBtn.classList).find(c => ['pass','warning','fail','skip','na'].includes(c)) : 'skip';
}

function markAllPass(section) {
    const s = sections[section];
    if (!s) return;
    for (let i = 0; i < s.items.length; i++) {
        setStatus(section, i, 'pass');
    }
    showAlert(`All items in ${s.t} marked as Pass`, 'success');
}

function markAllSkip(section) {
    const s = sections[section];
    if (!s) return;
    for (let i = 0; i < s.items.length; i++) {
        setStatus(section, i, 'skip');
    }
    showAlert(`All items in ${s.t} marked as Skip`, 'success');
}

function updateStats() {
    let pass = 0, warn = 0, fail = 0, skip = 0, na = 0, total = 0;
    let totalAllItems = 0, totalNAItems = 0;
    
    for (let [sectionKey, section] of Object.entries(sections)) {
        const isNA = document.getElementById(`na-${sectionKey}`).checked;
        
        // Count all items for the "items inspected" calculation
        totalAllItems += section.items.length;
        
        if (isNA) {
            // Count items in N/A sections
            totalNAItems += section.items.length;
            continue;
        }
        
        section.items.forEach((item, i) => {
            total++;
            const status = getItemStatus(sectionKey, i);
            if (status === 'pass') pass++;
            else if (status === 'warning') warn++;
            else if (status === 'fail') fail++;
            else if (status === 'skip') skip++;
            else if (status === 'na') na++;
        });
    }
    
    document.getElementById('passCount').textContent = pass;
    document.getElementById('warnCount').textContent = warn;
    document.getElementById('failCount').textContent = fail;
    document.getElementById('skipCount').textContent = skip;
    document.getElementById('naCount').textContent = na;
    
    // Update items inspected in heading (total items - items in N/A sections)
    const itemsInspected = totalAllItems - totalNAItems;
    document.getElementById('itemsInspectedText').textContent = itemsInspected;
    
    const completed = pass + warn + fail;
    const pct = itemsInspected > 0 ? ((completed / itemsInspected) * 100).toFixed(1) : '0.0';
    document.getElementById('completionPct').textContent = pct + '%';
    
    let photoCount = 0;
    ['RatingPlate', 'View1', 'View2'].forEach(type => {
        if (photos.info[type]) photoCount++;
    });
    Object.values(photos.lines).forEach(linePhotos => {
        photoCount += linePhotos.length;
    });
    document.getElementById('photoCount').textContent = photoCount;
}

function updateWordCount(textareaId, counterId, maxChars) {
    const textarea = document.getElementById(textareaId);
    const counter = document.getElementById(counterId);
    
    if (!textarea || !counter) return;
    
    const currentLength = textarea.value.length;
    const remaining = maxChars - currentLength;
    const percentage = (currentLength / maxChars) * 100;
    
    // Update counter text
    counter.textContent = `${currentLength}/${maxChars}`;
    
    // Update styling based on usage
    counter.classList.remove('warning', 'error');
    if (percentage >= 100) {
        counter.classList.add('error');
    } else if (percentage >= 80) {
        counter.classList.add('warning');
    }
}

function initializeAllWordCounters() {
    // Initialize comments counter
    updateWordCount('comments', 'commentsCounter', 2000);
    
    // Initialize inspection standard other counter
    updateWordCount('inspectionStandardOther', 'inspectionStandardOtherCounter', 200);
    
    // Initialize all notes counters
    for (let [sectionKey, section] of Object.entries(sections)) {
        section.items.forEach((item, i) => {
            updateWordCount(`nt-${sectionKey}-${i}`, `counter-${sectionKey}-${i}`, 500);
        });
    }
}

function updateSectionCompletion(sectionKey) {
    const section = sections[sectionKey];
    const isNA = document.getElementById(`na-${sectionKey}`).checked;
    
    if (isNA) {
        document.getElementById(`badge-${sectionKey}`).textContent = 'N/A';
        return;
    }
    
    let completed = 0;
    section.items.forEach((item, i) => {
        const status = getItemStatus(sectionKey, i);
        if (status !== 'skip') completed++;
    });
    
    document.getElementById(`badge-${sectionKey}`).textContent = `${completed}/${section.items.length}`;
}

function toggleSection(sectionKey) {
  const content = document.getElementById(`content-${sectionKey}`);
  const header = document.getElementById(`hdr-${sectionKey}`);
  if (!content || !header) return;
  if (content.classList.contains('expanded')) {
    content.classList.remove('expanded');
    header.classList.add('collapsed');
  } else {
    content.classList.add('expanded');
    header.classList.remove('collapsed');
  }
}

function toggleSectionNA(sectionKey) {
    const isNA = document.getElementById(`na-${sectionKey}`).checked;
    const content = document.getElementById(`content-${sectionKey}`);
    
    if (isNA) {
        content.classList.add('na-disabled');
    } else {
        content.classList.remove('na-disabled');
    }
    
    updateSectionCompletion(sectionKey);
    updateStats();
    markUnsaved();
}

function closePhotoViewer() {
    document.getElementById('photoViewer').classList.remove('active');
    document.getElementById('photoAnnotationPanel').classList.remove('active');
    document.body.style.overflow = 'auto';
}

function updatePhotoViewer() {
    if (!currentViewingPhoto) return;
    
    const img = document.getElementById('viewerImage');
    img.src = currentViewingPhoto.data;
    img.style.transform = `rotate(${currentPhotoRotation}deg) scale(${currentPhotoZoom}) translate(${photoTranslate.x}px, ${photoTranslate.y}px)`;
    
    const photoInfo = allPhotos[currentPhotoIndex];
    let infoText = `Photo ${currentPhotoIndex + 1} of ${allPhotos.length}`;
    if (photoInfo.type === 'info') {
        infoText += ` • ${photoInfo.ref}`;
    } else {
        infoText += ` • Line ${photoInfo.ref}`;
    }
    if (currentViewingPhoto.annotation) {
        infoText += ' • Has note';
    }
    
    document.getElementById('photoViewerInfo').textContent = infoText;
    document.getElementById('prevPhotoBtn').disabled = currentPhotoIndex === 0;
    document.getElementById('nextPhotoBtn').disabled = currentPhotoIndex === allPhotos.length - 1;
    document.getElementById('annotationText').value = currentViewingPhoto.annotation || '';
}

function navigatePhoto(direction) {
    const newIndex = currentPhotoIndex + direction;
    if (newIndex >= 0 && newIndex < allPhotos.length) {
        saveCurrentRotation();
        currentPhotoIndex = newIndex;
        currentViewingPhoto = allPhotos[newIndex].photo;
        currentPhotoRotation = currentViewingPhoto.rotation || 0;
        currentPhotoZoom = 1;
        photoTranslate = {x: 0, y: 0};
        updatePhotoViewer();
        document.getElementById('photoAnnotationPanel').classList.remove('active');
    }
}

function rotatePhoto(degrees) {
    currentPhotoRotation = (currentPhotoRotation + degrees) % 360;
    if (currentPhotoRotation < 0) currentPhotoRotation += 360;
    updatePhotoViewer();
}

function resetPhotoRotation() {
    currentPhotoRotation = 0;
    updatePhotoViewer();
}

function saveCurrentRotation() {
    if (currentViewingPhoto) {
        currentViewingPhoto.rotation = currentPhotoRotation;
        markUnsaved();
    }
}

function zoomPhoto(factor) {
    currentPhotoZoom = Math.max(0.5, Math.min(5, currentPhotoZoom * factor));
    updatePhotoViewer();
}

function resetPhotoZoom() {
    currentPhotoZoom = 1;
    photoTranslate = {x: 0, y: 0};
    updatePhotoViewer();
}

function toggleAnnotation() {
    const panel = document.getElementById('photoAnnotationPanel');
    panel.classList.toggle('active');
}

function saveAnnotation() {
    const text = document.getElementById('annotationText').value;
    if (currentViewingPhoto) {
        currentViewingPhoto.annotation = text;
        
        const dbEntry = photoDatabase.find(p => p.filename === currentViewingPhoto.filename);
        if (dbEntry) {
            dbEntry.annotation = text;
        }
        
        const photoInfo = allPhotos[currentPhotoIndex];
        if (photoInfo.type === 'info') {
            renderInfoPhotoThumb(photoInfo.ref);
        } else {
            for (let [sectionKey, section] of Object.entries(sections)) {
                section.items.forEach((item, i) => {
                    if (getItemNumber(sectionKey, i) === photoInfo.ref) {
                        renderLinePhotos(sectionKey, i);
                    }
                });
            }
        }
    }
    
    updatePhotoViewer();
    toggleAnnotation();
    markUnsaved();
    showAlert('Photo annotation saved', 'success');
}

function downloadCurrentPhoto() {
    if (!currentViewingPhoto) return;
    const link = document.createElement('a');
    link.href = currentViewingPhoto.data;
    link.download = currentViewingPhoto.filename || 'photo.jpg';
    link.click();
}

const viewerImg = document.getElementById('viewerImage');
viewerImg.addEventListener('mousedown', (e) => {
    if (currentPhotoZoom > 1) {
        isDragging = true;
        dragStart = {x: e.clientX - photoTranslate.x, y: e.clientY - photoTranslate.y};
        viewerImg.style.cursor = 'grabbing';
    }
});

document.addEventListener('mousemove', (e) => {
    if (isDragging) {
        photoTranslate.x = e.clientX - dragStart.x;
        photoTranslate.y = e.clientY - dragStart.y;
        updatePhotoViewer();
    }
});

document.addEventListener('mouseup', () => {
    if (isDragging) {
        isDragging = false;
        viewerImg.style.cursor = 'move';
        saveCurrentRotation();
    }
});

viewerImg.addEventListener('wheel', (e) => {
    e.preventDefault();
    const factor = e.deltaY < 0 ? 1.1 : 0.9;
    zoomPhoto(factor);
});

function showPhotoDatabase() {
    const modal = document.getElementById('photoDbModal');
    const content = document.getElementById('photoDbContent');
    
    if (photoDatabase.length === 0) {
        content.innerHTML = '<div style="padding:2rem; text-align:center; color:#6b7280;">No photos in database</div>';
    } else {
        content.innerHTML = photoDatabase.map((photo, index) => {
            const sizeMB = (photo.fileSize / (1024 * 1024)).toFixed(2);
            const date = new Date(photo.timestamp).toLocaleString();
            const lineInfo = photo.lineNumber ? `Line ${photo.lineNumber}` : photo.photoType;
            
            return `
                <div class="photo-database-item">
                    <div>
                        <div class="photo-database-filename">${photo.filename}</div>
                        <div class="photo-database-meta">${lineInfo} • ${date} • ${sizeMB}MB${photo.annotation ? ' • Annotated' : ''}</div>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    modal.classList.add('active');
}

function closePhotoDatabase() {
    document.getElementById('photoDbModal').classList.remove('active');
}

function exportPhotoDatabase() {
    const csvContent = [
        ['Filename', 'Timestamp', 'Line Number', 'Photo Type', 'File Size (bytes)', 'Annotation'],
        ...photoDatabase.map(p => [
            p.filename,
            p.timestamp,
            p.lineNumber || '',
            p.photoType || '',
            p.fileSize,
            p.annotation || ''
        ])
    ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
    
    const blob = new Blob([csvContent], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `Photo_Database_${new Date().toISOString().split('T')[0]}.csv`;
    link.click();
    URL.revokeObjectURL(url);
    
    showAlert('Photo database exported', 'success');
}

// Executive Summary Functions
function showExecutiveSummary() {
    const modal = document.getElementById('executiveSummaryModal');
    const content = document.getElementById('executiveSummaryContent');
    
    const data = getFormData();
    const stats = calculateInspectionStats(data);
    
    content.innerHTML = generateExecutiveSummaryHTML(data, stats);
    modal.classList.add('active');
}

function closeExecutiveSummary() {
    document.getElementById('executiveSummaryModal').classList.remove('active');
}

function calculateInspectionStats(data) {
    let totalItems = 0;
    let completedItems = 0;
    let passCount = 0;
    let warningCount = 0;
    let failCount = 0;
    let skipCount = 0;
    let naCount = 0;
    let itemsWithNotes = 0;
    let criticalIssues = [];
    let sectionStats = {};
    
    for (let [sectionKey, section] of Object.entries(sections)) {
        const sectionData = data.sections[sectionKey] || { na: false, items: [] };
        const isNA = sectionData.na;
        
        let sectionCompleted = 0;
        let sectionTotal = section.items.length;
        
        sectionStats[sectionKey] = {
            name: section.t,
            total: sectionTotal,
            completed: 0,
            pass: 0,
            warning: 0,
            fail: 0,
            skip: 0,
            na: isNA,
            percentage: 0
        };
        
        if (isNA) {
            naCount += sectionTotal;
            totalItems += sectionTotal;
            completedItems += sectionTotal;
            sectionStats[sectionKey].completed = sectionTotal;
            sectionStats[sectionKey].percentage = 100;
            continue;
        }
        
        section.items.forEach((item, i) => {
            totalItems++;
            const itemData = sectionData.items[i] || { status: 'skip', notes: '' };
            const status = itemData.status || 'skip';
            
            if (status !== 'skip') {
                completedItems++;
                sectionCompleted++;
                
                if (status === 'pass') {
                    passCount++;
                    sectionStats[sectionKey].pass++;
                } else if (status === 'warning') {
                    warningCount++;
                    sectionStats[sectionKey].warning++;
                    criticalIssues.push({
                        section: section.t,
                        item: item,
                        status: 'Warning',
                        notes: itemData.notes || 'No notes'
                    });
                } else if (status === 'fail') {
                    failCount++;
                    sectionStats[sectionKey].fail++;
                    criticalIssues.push({
                        section: section.t,
                        item: item,
                        status: 'Fail',
                        notes: itemData.notes || 'No notes'
                    });
                }
            } else {
                skipCount++;
                sectionStats[sectionKey].skip++;
            }
            
            if (itemData.notes) {
                itemsWithNotes++;
            }
        });
        
        sectionStats[sectionKey].completed = sectionCompleted;
        sectionStats[sectionKey].percentage = sectionTotal > 0 ? Math.round((sectionCompleted / sectionTotal) * 100) : 0;
    }
    
    const completionPercentage = totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;
    
    return {
        totalItems,
        completedItems,
        completionPercentage,
        passCount,
        warningCount,
        failCount,
        skipCount,
        naCount,
        itemsWithNotes,
        totalPhotos: photoDatabase.length,
        criticalIssues,
        sectionStats
    };
}

function generateExecutiveSummaryHTML(data, stats) {
    const info = data.info;
    const date = new Date().toLocaleDateString();
    const time = new Date().toLocaleTimeString();
    
    let overallStatus = 'PASS';
    let statusColor = '#16a34a';
    if (stats.failCount > 0) {
        overallStatus = 'FAIL';
        statusColor = '#dc2626';
    } else if (stats.warningCount > 0) {
        overallStatus = 'WARNING';
        statusColor = '#f59e0b';
    }
    
    return '<div style="font-family: Arial, sans-serif;"><div style="background: #005DAA; padding: 1.5rem; margin-bottom: 2rem; border-radius: 0.5rem; display: flex; align-items: center; position: relative;"><img src="' + LOGO_BASE64 + '" alt="Doble Logo" style="height: 60px; position: absolute; left: 1.5rem;"><div style="color: white; flex: 1; text-align: center;"><h1 style="margin: 0; font-size: 1.3rem; font-weight: 600; color: white;">TRANSFORMER INSPECTION</h1><h2 style="margin: 0.25rem 0 0 0; font-size: 1rem; font-weight: 400; color: white;">Executive Summary Report</h2></div></div><div style="background: #f9fafb; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;"><h3 style="margin-top: 0; color: #374151;">Transformer Information</h3><table style="width: 100%;"><tr><td style="padding: 0.5rem; font-weight: 600;">Transformer ID:</td><td style="padding: 0.5rem;">' + (info.transformerId || 'Not specified') + '</td><td style="padding: 0.5rem; font-weight: 600;">Location:</td><td style="padding: 0.5rem;">' + (info.location || 'Not specified') + '</td></tr><tr><td style="padding: 0.5rem; font-weight: 600;">Inspector:</td><td style="padding: 0.5rem;">' + (info.inspector || 'Not specified') + '</td><td style="padding: 0.5rem; font-weight: 600;">Date:</td><td style="padding: 0.5rem;">' + (info.date || 'Not specified') + '</td></tr></table></div><div style="background: ' + statusColor + '; color: white; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem; text-align: center;"><div style="font-size: 2.5rem; font-weight: bold;">' + overallStatus + '</div><div style="font-size: 1.1rem;">Completion: ' + stats.completionPercentage + '%</div></div><div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem;"><div style="background: #C6EFCE; padding: 1rem; border-radius: 0.5rem; text-align: center;"><div style="font-size: 2rem; font-weight: bold; color: #166534;">' + stats.passCount + '</div><div style="color: #166534; font-weight: 600;">PASS</div></div><div style="background: #FFD966; padding: 1rem; border-radius: 0.5rem; text-align: center;"><div style="font-size: 2rem; font-weight: bold; color: #854d0e;">' + stats.warningCount + '</div><div style="color: #854d0e; font-weight: 600;">WARNING</div></div><div style="background: #FFC7CE; padding: 1rem; border-radius: 0.5rem; text-align: center;"><div style="font-size: 2rem; font-weight: bold; color: #991b1b;">' + stats.failCount + '</div><div style="color: #991b1b; font-weight: 600;">FAIL</div></div><div style="background: #e5e7eb; padding: 1rem; border-radius: 0.5rem; text-align: center;"><div style="font-size: 2rem; font-weight: bold; color: #4b5563;">' + stats.skipCount + '</div><div style="color: #4b5563; font-weight: 600;">NOT INSPECTED</div></div></div><div style="background: #f9fafb; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;"><h3 style="margin-top: 0; color: #374151;">Section Breakdown</h3><table style="width: 100%; border-collapse: collapse;"><thead><tr style="background: #e5e7eb;"><th style="padding: 0.75rem; text-align: left; border: 1px solid #d1d5db;">Section</th><th style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db;">Complete</th><th style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db;">Pass</th><th style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db;">Warn</th><th style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db;">Fail</th></tr></thead><tbody>' + Object.entries(stats.sectionStats).map(([key, section]) => '<tr><td style="padding: 0.75rem; border: 1px solid #d1d5db;">' + section.name + (section.na ? ' (N/A)' : '') + '</td><td style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db;">' + section.percentage + '%</td><td style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db; color: #166534;">' + section.pass + '</td><td style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db; color: #854d0e;">' + section.warning + '</td><td style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db; color: #991b1b;">' + section.fail + '</td></tr>').join('') + '</tbody></table></div>' + (stats.criticalIssues.length > 0 ? '<div style="background: #fef2f2; border: 2px solid #dc2626; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;"><h3 style="margin-top: 0; color: #dc2626;">Critical Issues</h3>' + stats.criticalIssues.map((issue, i) => '<div style="margin-bottom: 1rem; padding: 1rem; background: white; border-left: 4px solid ' + (issue.status === 'Fail' ? '#dc2626' : '#f59e0b') + ';"><div style="font-weight: 600;">' + (i + 1) + '. ' + issue.section + '</div><div style="color: #6b7280;">' + issue.item + '</div><div><span style="background: ' + (issue.status === 'Fail' ? '#FFC7CE' : '#FFD966') + '; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem; font-weight: 600;">' + issue.status + '</span> <span style="color: #6b7280;">' + issue.notes + '</span></div></div>').join('') + '</div>' : '') + '<div style="text-align: center; color: #6b7280; font-size: 0.85rem; padding-top: 1rem; border-top: 1px solid #e5e7eb;">Generated: ' + date + ' ' + time + '</div></div>';
}

function printExecutiveSummary() {
    const content = document.getElementById('executiveSummaryContent').innerHTML;
    const printWindow = window.open('', '_blank');
    printWindow.document.write('<!DOCTYPE html><html><head><title>Executive Summary</title><style>body { font-family: Arial, sans-serif; padding: 1rem; } @media print { body { margin: 0; } }</style></head><body>' + content + '</body></html>');
    printWindow.document.close();
    setTimeout(() => printWindow.print(), 500);
}

// Save All Documents - Bundle everything into ZIP
async function saveAllDocuments() {
    try {
        // Show progress modal
        showExportProgress();
        updateExportProgress('Initializing...', 0);
        
        const data = getFormData();
        const transformerId = data.info.transformerId || 'Unknown';
        const date = data.info.date || new Date().toISOString().split('T')[0];
        const zipFilename = `Inspection_${transformerId}_${date}.zip`;
        
        // Create ZIP
        const zip = new JSZip();
        
        // 1. Excel Inspection Report (20% progress)
        updateExportProgress('Generating Excel inspection report...', 20);
        const excelBlob = await generateExcelBlob(`Inspection_Report_${transformerId}.xlsx`);
        if (!excelBlob) {
            throw new Error('Failed to generate Excel report');
        }
        zip.file(`1_Inspection_Report_${transformerId}.xlsx`, excelBlob);
        console.log('✓ Excel report added to package');
        
        // 2. Executive Summary HTML (40% progress)
        updateExportProgress('Generating executive summary report...', 40);
        const stats = calculateInspectionStats(data);
        const summaryHTML = generateExecutiveSummaryHTML(data, stats);
        const fullSummaryHTML = generateStandaloneHTML('Executive Summary', summaryHTML);
        if (!fullSummaryHTML) {
            throw new Error('Failed to generate executive summary');
        }
        zip.file(`2_Executive_Summary_${transformerId}.html`, fullSummaryHTML);
        console.log('✓ Executive summary added to package');
        
        // 3. Photo List (60% progress)
        updateExportProgress('Generating photo list document...', 60);
        const photoListHTML = generatePhotoListHTML(data);
        if (!photoListHTML) {
            throw new Error('Failed to generate photo list');
        }
        zip.file(`3_Photo_List_${transformerId}.html`, photoListHTML);
        console.log('✓ Photo list added to package');
        
        // 4. Photo Gallery - 4 per page (75% progress)
        updateExportProgress('Generating photo gallery (4 per page)...', 75);
        if (photoDatabase.length > 0) {
            const photoGalleryHTML = generatePhotoGalleryHTML(data);
            if (!photoGalleryHTML) {
                throw new Error('Failed to generate photo gallery');
            }
            zip.file(`4_Photo_Gallery_${transformerId}.html`, photoGalleryHTML);
            console.log(`✓ Photo gallery added to package (${photoDatabase.length} photos, 4 per page)`);
        } else {
            // Create a placeholder file explaining no photos were captured
            const noPhotosHTML = generateStandaloneHTML('Photo Gallery', 
                '<div style="text-align:center; padding:3rem; color:#6b7280;"><h2>No Photos Captured</h2><p>This inspection did not include any photographs.</p></div>');
            zip.file(`4_Photo_Gallery_${transformerId}.html`, noPhotosHTML);
            console.log('✓ Photo gallery placeholder added (no photos captured)');
        }
        
        // 5. JSON Data Backup (90% progress)
        updateExportProgress('Adding data backup file...', 90);
        const jsonData = JSON.stringify(data, null, 2);
        zip.file(`5_Data_Backup_${transformerId}.json`, jsonData);
        console.log('✓ JSON backup added to package');
        
        // Generate and download ZIP (95% progress)
        updateExportProgress('Creating ZIP file...', 95);
        const zipBlob = await zip.generateAsync({ 
            type: 'blob',
            compression: 'DEFLATE',
            compressionOptions: { level: 6 }
        });
        
        // Download (100% progress)
        updateExportProgress('Download starting...', 100);
        const url = URL.createObjectURL(zipBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = zipFilename;
        link.click();
        
        // Clean up
        setTimeout(() => URL.revokeObjectURL(url), 100);
        
        // Show success message with details
        const fileCount = 4 + (photoDatabase.length > 0 ? 1 : 1); // Excel + Summary + Photo List + Gallery + JSON
        const photoInfo = photoDatabase.length > 0 ? `, ${photoDatabase.length} photos` : ', no photos';
        
        setTimeout(() => {
            closeExportProgress();
            showAlert(`✓ Complete inspection package saved!\n\nPackage contains:\n• Inspection Report (Excel)\n• Executive Summary (HTML)\n• Photo List (HTML)\n• Photo Gallery - 4 per page (HTML)${photoInfo}\n• Data Backup (JSON)\n\nFile: ${zipFilename}`, 'success');
        }, 500);
        
        console.log(`✓✓✓ Complete package generated: ${zipFilename}`);
        console.log(`    Files included: ${fileCount}`);
        console.log(`    Photos: ${photoDatabase.length}`);
        
    } catch (error) {
        console.error('Error generating package:', error);
        closeExportProgress();
        showAlert('Error generating package: ' + error.message + '\n\nPlease check the console for details and try again.', 'error');
    }
}

// Helper functions for export progress modal
function showExportProgress() {
    const modal = document.getElementById('exportProgressModal');
    if (modal) {
        modal.style.display = 'flex';
    }
}

function updateExportProgress(phase, percentage) {
    const phaseElement = document.getElementById('exportPhase');
    const progressBar = document.getElementById('exportProgressBar');
    
    if (phaseElement) {
        phaseElement.textContent = phase;
    }
    if (progressBar) {
        progressBar.style.width = percentage + '%';
    }
}

function closeExportProgress() {
    const modal = document.getElementById('exportProgressModal');
    if (modal) {
        modal.style.display = 'none';
    }
}

function generateStandaloneHTML(title, content) {
    return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title}</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; max-width: 1200px; margin: 0 auto; }
        @media print { body { margin: 0; padding: 1rem; } }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body>
    <div class="no-print" style="margin-bottom: 1rem; padding: 1rem; background: #f3f4f6; border-radius: 0.5rem;">
        <button onclick="window.print()" style="padding: 0.5rem 1rem; background: #2563eb; color: white; border: none; border-radius: 0.375rem; cursor: pointer;">🖨️ Print / Save as PDF</button>
    </div>
    ${content}
</body>
</html>`;
}

function generatePhotoListHTML(data) {
    const info = data.info;
    const date = new Date().toLocaleDateString();
    const time = new Date().toLocaleTimeString();
    
    let html = `
        <div style="font-family: Arial, sans-serif;">
            <div style="text-align: center; border-bottom: 3px solid #005DAA; padding-bottom: 1rem; margin-bottom: 2rem;">
                <h1 style="color: #005DAA; margin: 0;">PHOTO LIST</h1>
                <h2 style="color: #374151; margin: 0.5rem 0;">Transformer Inspection</h2>
                <div style="color: #6b7280; font-size: 0.9rem;">Generated: ${date} ${time}</div>
            </div>
            
            <div style="background: #f9fafb; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                <table style="width: 100%;">
                    <tr>
                        <td style="padding: 0.5rem; font-weight: 600;">Transformer ID:</td>
                        <td style="padding: 0.5rem;">${info.transformerId || 'Not specified'}</td>
                        <td style="padding: 0.5rem; font-weight: 600;">Location:</td>
                        <td style="padding: 0.5rem;">${info.location || 'Not specified'}</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem; font-weight: 600;">Inspector:</td>
                        <td style="padding: 0.5rem;">${info.inspector || 'Not specified'}</td>
                        <td style="padding: 0.5rem; font-weight: 600;">Date:</td>
                        <td style="padding: 0.5rem;">${info.date || 'Not specified'}</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem; font-weight: 600;">Total Photos:</td>
                        <td colspan="3" style="padding: 0.5rem;">${photoDatabase.length}</td>
                    </tr>
                </table>
            </div>
            
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                <thead>
                    <tr style="background: #005DAA; color: white;">
                        <th style="padding: 0.75rem; text-align: left; border: 1px solid #003d73;">#</th>
                        <th style="padding: 0.75rem; text-align: left; border: 1px solid #003d73;">Filename</th>
                        <th style="padding: 0.75rem; text-align: left; border: 1px solid #003d73;">Section/Type</th>
                        <th style="padding: 0.75rem; text-align: left; border: 1px solid #003d73;">Timestamp</th>
                        <th style="padding: 0.75rem; text-align: left; border: 1px solid #003d73;">Size</th>
                        <th style="padding: 0.75rem; text-align: left; border: 1px solid #003d73;">Notes</th>
                    </tr>
                </thead>
                <tbody>`;
    
    if (photoDatabase.length === 0) {
        html += '<tr><td colspan="6" style="padding: 2rem; text-align: center; color: #6b7280;">No photos captured</td></tr>';
    } else {
        photoDatabase.forEach((photo, index) => {
            const timestamp = new Date(photo.timestamp).toLocaleString();
            const sizeMB = (photo.fileSize / (1024 * 1024)).toFixed(2);
            const section = photo.lineNumber ? `Line ${photo.lineNumber}` : (photo.photoType || 'General');
            
            html += `
                <tr style="background: ${index % 2 === 0 ? 'white' : '#f9fafb'};">
                    <td style="padding: 0.75rem; border: 1px solid #d1d5db;">${index + 1}</td>
                    <td style="padding: 0.75rem; border: 1px solid #d1d5db; font-family: monospace; font-size: 0.85rem;">${photo.filename}</td>
                    <td style="padding: 0.75rem; border: 1px solid #d1d5db;">${section}</td>
                    <td style="padding: 0.75rem; border: 1px solid #d1d5db; white-space: nowrap;">${timestamp}</td>
                    <td style="padding: 0.75rem; border: 1px solid #d1d5db;">${sizeMB} MB</td>
                    <td style="padding: 0.75rem; border: 1px solid #d1d5db;">${photo.annotation || '-'}</td>
                </tr>`;
        });
    }
    
    html += `
                </tbody>
            </table>
            
            <div style="margin-top: 2rem; padding-top: 1rem; border-top: 2px solid #d1d5db; color: #6b7280; font-size: 0.85rem; text-align: center;">
                <div>This photo list was generated from the Power Transformer Inspection Form.</div>
                <div style="margin-top: 0.25rem;">Inspector: ${info.inspector || 'Not specified'} | Date: ${info.date || 'Not specified'}</div>
            </div>
        </div>`;
    
    return generateStandaloneHTML('Photo List', html);
}

function generatePhotoGalleryHTML(data) {
    const info = data.info;
    const date = new Date().toLocaleDateString();
    const time = new Date().toLocaleTimeString();
    const photosPerPage = 4;
    
    let html = `
        <div style="font-family: Arial, sans-serif;">
            <div style="text-align: center; border-bottom: 3px solid #005DAA; padding-bottom: 1rem; margin-bottom: 2rem;">
                <h1 style="color: #005DAA; margin: 0;">PHOTO GALLERY</h1>
                <h2 style="color: #374151; margin: 0.5rem 0;">Transformer Inspection</h2>
                <div style="color: #6b7280; font-size: 0.9rem;">Generated: ${date} ${time}</div>
            </div>
            
            <div style="background: #f9fafb; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 2rem;">
                <table style="width: 100%;">
                    <tr>
                        <td style="padding: 0.5rem; font-weight: 600;">Transformer ID:</td>
                        <td style="padding: 0.5rem;">${info.transformerId || 'Not specified'}</td>
                        <td style="padding: 0.5rem; font-weight: 600;">Location:</td>
                        <td style="padding: 0.5rem;">${info.location || 'Not specified'}</td>
                    </tr>
                    <tr>
                        <td style="padding: 0.5rem; font-weight: 600;">Inspector:</td>
                        <td style="padding: 0.5rem;">${info.inspector || 'Not specified'}</td>
                        <td style="padding: 0.5rem; font-weight: 600;">Date:</td>
                        <td style="padding: 0.5rem;">${info.date || 'Not specified'}</td>
                    </tr>
                </table>
            </div>`;
    
    if (photoDatabase.length === 0) {
        html += '<div style="padding: 2rem; text-align: center; color: #6b7280;">No photos to display</div>';
    } else {
        // Group photos into pages of 4
        for (let pageStart = 0; pageStart < photoDatabase.length; pageStart += photosPerPage) {
            const pagePhotos = photoDatabase.slice(pageStart, pageStart + photosPerPage);
            const pageNum = Math.floor(pageStart / photosPerPage) + 1;
            const totalPages = Math.ceil(photoDatabase.length / photosPerPage);
            
            if (pageStart > 0) {
                html += '<div style="page-break-before: always;"></div>';
            }
            
            html += `
                <div style="margin-bottom: 2rem;">
                    <div style="text-align: right; color: #6b7280; font-size: 0.85rem; margin-bottom: 1rem;">Page ${pageNum} of ${totalPages}</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">`;
            
            pagePhotos.forEach((photo, index) => {
                const globalIndex = pageStart + index + 1;
                const timestamp = new Date(photo.timestamp).toLocaleString();
                const section = photo.lineNumber ? `Line ${photo.lineNumber}` : (photo.photoType || 'General');
                
                // Get the actual photo data
                let photoSrc = '';
                if (photo.lineNumber !== undefined) {
                    // Line photo
                    const sectionKey = Object.keys(sections).find(key => 
                        sections[key].items.some((item, i) => 
                            photos[key] && photos[key][i] && photos[key][i] === photo.data
                        )
                    );
                    if (sectionKey) {
                        const itemIndex = sections[sectionKey].items.findIndex((item, i) => 
                            photos[sectionKey] && photos[sectionKey][i] === photo.data
                        );
                        if (itemIndex >= 0 && photos[sectionKey][itemIndex]) {
                            photoSrc = photos[sectionKey][itemIndex];
                        }
                    }
                } else {
                    // Info photo
                    const infoPhotoKey = Object.keys(photos.info || {}).find(key => 
                        photos.info[key] === photo.data
                    );
                    if (infoPhotoKey && photos.info[infoPhotoKey]) {
                        photoSrc = photos.info[infoPhotoKey];
                    }
                }
                
                html += `
                    <div style="border: 1px solid #d1d5db; border-radius: 0.5rem; padding: 1rem; background: white;">
                        <div style="font-weight: 600; color: #374151; margin-bottom: 0.5rem;">Photo ${globalIndex}: ${section}</div>
                        <div style="text-align: center; margin: 1rem 0; background: #f9fafb; padding: 0.5rem; border-radius: 0.375rem;">
                            <img src="${photoSrc}" style="max-width: 100%; max-height: 400px; height: auto; border-radius: 0.375rem;" />
                        </div>
                        <div style="font-size: 0.85rem; color: #6b7280; margin-top: 0.5rem;">
                            <div><strong>File:</strong> ${photo.filename}</div>
                            <div><strong>Time:</strong> ${timestamp}</div>
                            ${photo.annotation ? `<div><strong>Notes:</strong> ${photo.annotation}</div>` : ''}
                        </div>
                    </div>`;
            });
            
            html += `
                    </div>
                </div>`;
        }
    }
    
    html += `
            <div style="margin-top: 2rem; padding-top: 1rem; border-top: 2px solid #d1d5db; color: #6b7280; font-size: 0.85rem; text-align: center; page-break-inside: avoid;">
                <div>This photo gallery was generated from the Power Transformer Inspection Form.</div>
                <div style="margin-top: 0.25rem;">Inspector: ${info.inspector || 'Not specified'} | Date: ${info.date || 'Not specified'}</div>
            </div>
        </div>`;
    
    return generateStandaloneHTML('Photo Gallery', html);
}

function saveDataToJSON() {
    showJsonFilenameModal();
}

function showJsonFilenameModal() {
    const data = getFormData();
    
    // Generate default filename
    const transformerId = data.info.transformerId || 'Unknown';
    const location = data.info.location ? '_' + data.info.location.replace(/[^a-zA-Z0-9]/g, '_').substring(0, 20) : '';
    const date = data.info.date || new Date().toISOString().split('T')[0];
    const defaultFilename = `Inspection${location}_${transformerId}_${date}.json`;
    
    // Set filename
    document.getElementById('jsonFilename').value = defaultFilename;
    
    // Populate summary
    document.getElementById('jsonSummaryId').textContent = data.info.transformerId || '-';
    document.getElementById('jsonSummaryDate').textContent = data.info.date || '-';
    document.getElementById('jsonSummaryLocation').textContent = data.info.location || '-';
    document.getElementById('jsonSummaryPhotos').textContent = photoDatabase.length;
    
    // Show modal
    document.getElementById('jsonFilenameModal').classList.add('active');
    
    // Focus and select filename for easy editing
    setTimeout(() => {
        const filenameInput = document.getElementById('jsonFilename');
        filenameInput.focus();
        // Select just the filename part (before .json)
        const extensionIndex = filenameInput.value.lastIndexOf('.json');
        if (extensionIndex > 0) {
            filenameInput.setSelectionRange(0, extensionIndex);
        }
    }, 100);
}

function closeJsonFilenameModal() {
    document.getElementById('jsonFilenameModal').classList.remove('active');
}

function confirmJsonExport() {
    closeJsonFilenameModal();
    
    // Get custom filename
    let filename = document.getElementById('jsonFilename').value.trim();
    
    // Ensure .json extension
    if (!filename.toLowerCase().endsWith('.json')) {
        filename += '.json';
    }
    
    // Validate filename
    if (!filename || filename === '.json') {
        showAlert('Please enter a valid filename', 'error');
        showJsonFilenameModal();
        return;
    }
    
    executeJsonSave(filename);
}

function executeJsonSave(filename) {
    try {
        const data = getFormData();
        const jsonString = JSON.stringify(data, null, 2);
        const blob = new Blob([jsonString], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        
        link.href = url;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        // Clean up
        setTimeout(() => {
            URL.revokeObjectURL(url);
        }, 100);
        
        showAlert('Inspection data saved successfully! Check your Downloads folder.', 'success');
    } catch (err) {
        console.error('JSON save error:', err);
        showAlert('Error saving data: ' + err.message, 'error');
    }
}

function printPhotoList() {
    if (photoDatabase.length === 0) {
        showAlert('No photos to print', 'error');
        return;
    }
    
    const transformerId = document.getElementById('transformerId').value || 'Unknown';
    const location = document.getElementById('location').value || 'Unknown';
    const date = document.getElementById('date').value || new Date().toISOString().split('T')[0];
    const inspector = document.getElementById('inspector')?.value || 'Unknown';
    
    // Create printable HTML
    let printContent = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Photo Inventory - ${transformerId}</title>
            <style>
                @page { margin: 1.5cm; }
                body { font-family: Arial, sans-serif; font-size: 11pt; line-height: 1.4; }
                h1 { font-size: 18pt; color: #005DAA; margin-bottom: 0.5rem; }
                h2 { font-size: 14pt; color: #374151; margin-top: 1rem; margin-bottom: 0.5rem; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.25rem; }
                .header-info { background: #f3f4f6; padding: 0.75rem; border-radius: 0.375rem; margin-bottom: 1rem; }
                .header-info div { margin: 0.25rem 0; }
                .header-info strong { color: #374151; }
                table { width: 100%; border-collapse: collapse; margin-bottom: 1rem; }
                th { background: #e5e7eb; padding: 0.5rem; text-align: left; font-weight: 600; border: 1px solid #d1d5db; }
                td { padding: 0.5rem; border: 1px solid #d1d5db; vertical-align: top; }
                tr:nth-child(even) { background: #f9fafb; }
                .photo-type { font-weight: 600; color: #2563eb; }
                .line-number { background: #dbeafe; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 9pt; }
                .annotation { color: #ea580c; font-style: italic; }
                .footer { text-align: center; font-size: 9pt; color: #6b7280; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; }
                .summary { background: #fef3c7; padding: 0.75rem; border-radius: 0.375rem; margin-bottom: 1rem; }
            </style>
        </head>
        <body>
            <h1>📷 Photo Inventory Report</h1>
            
            <div class="header-info">
                <div><strong>Transformer ID:</strong> ${transformerId}</div>
                <div><strong>Location:</strong> ${location}</div>
                <div><strong>Inspection Date:</strong> ${date}</div>
                <div><strong>Inspector:</strong> ${inspector}</div>
                <div><strong>Report Generated:</strong> ${new Date().toLocaleString()}</div>
            </div>
            
            <div class="summary">
                <strong>Total Photos:</strong> ${photoDatabase.length} | 
                <strong>Annotated:</strong> ${photoDatabase.filter(p => p.annotation).length} | 
                <strong>Total Size:</strong> ${(photoDatabase.reduce((sum, p) => sum + p.fileSize, 0) / (1024 * 1024)).toFixed(2)} MB
            </div>
            
            <h2>Photo Details</h2>
            <table>
                <thead>
                    <tr>
                        <th style="width: 5%;">#</th>
                        <th style="width: 25%;">Filename</th>
                        <th style="width: 15%;">Type/Line</th>
                        <th style="width: 15%;">Date & Time</th>
                        <th style="width: 10%;">Size</th>
                        <th style="width: 30%;">Annotation</th>
                    </tr>
                </thead>
                <tbody>
    `;
    
    photoDatabase.forEach((photo, index) => {
        const photoDate = new Date(photo.timestamp).toLocaleString();
        const sizeMB = (photo.fileSize / (1024 * 1024)).toFixed(2);
        const lineInfo = photo.lineNumber 
            ? `<span class="line-number">Line ${photo.lineNumber}</span>` 
            : `<span class="photo-type">${photo.photoType}</span>`;
        const annotation = photo.annotation 
            ? `<span class="annotation">${photo.annotation}</span>` 
            : '<span style="color: #9ca3af;">No annotation</span>';
        
        printContent += `
            <tr>
                <td style="text-align: center;">${index + 1}</td>
                <td><code style="font-size: 9pt;">${photo.filename}</code></td>
                <td>${lineInfo}</td>
                <td style="font-size: 9pt;">${photoDate}</td>
                <td style="text-align: right;">${sizeMB} MB</td>
                <td>${annotation}</td>
            </tr>
        `;
    });
    
    printContent += `
                </tbody>
            </table>
            
            <div class="footer">
                Power Transformer Inspection Form v0.74 – Photo Inventory Report<br>
                This document lists all photos captured during the inspection. Photos are stored separately.
            </div>
        </body>
        </html>
    `;
    
    // Open print dialog
    const printWindow = window.open('', '_blank');
    printWindow.document.write(printContent);
    printWindow.document.close();
    
    // Wait for content to load, then trigger print
    printWindow.onload = function() {
        printWindow.print();
    };
}

function validateFormData() {
    const errors = [];
    const warnings = [];
    const info = [];
    
    const requiredFields = [
        {id: 'transformerId', label: 'Transformer ID'},
        {id: 'location', label: 'Location'},
        {id: 'manufacturer', label: 'Manufacturer'},
        {id: 'status', label: 'Status'},
        {id: 'access', label: 'Access'},
        {id: 'date', label: 'Inspection Date'}
    ];
    
    requiredFields.forEach(field => {
        const element = document.getElementById(field.id);
        if (!element || !element.value.trim()) {
            errors.push(`${field.label} is required`);
        }
    });
    
    let totalItems = 0;
    let completedItems = 0;
    let failedItems = 0;
    
    for (let [sectionKey, section] of Object.entries(sections)) {
        const isNA = document.getElementById(`na-${sectionKey}`).checked;
        if (isNA) {
            info.push(`${section.t} marked as N/A`);
            continue;
        }
        
        section.items.forEach((item, i) => {
            totalItems++;
            const status = getItemStatus(sectionKey, i);
            if (status !== 'skip') completedItems++;
            if (status === 'fail') failedItems++;
        });
    }
    
    const completionRate = totalItems > 0 ? (completedItems / totalItems) * 100 : 0;
    
    if (completionRate < 50) {
        warnings.push(`Only ${Math.round(completionRate)}% of items completed`);
    }
    
    if (failedItems > 0) {
        warnings.push(`${failedItems} item(s) failed inspection`);
    }
    
    let photoCount = 0;
    ['RatingPlate', 'View1', 'View2'].forEach(type => {
        if (photos.info[type]) photoCount++;
    });
    Object.values(photos.lines).forEach(linePhotos => {
        photoCount += linePhotos.length;
    });
    
    if (photoCount === 0) {
        warnings.push('No photos attached');
    } else {
        info.push(`${photoCount} photo(s) attached`);
    }
    
    const annotatedPhotos = photoDatabase.filter(p => p.annotation).length;
    if (annotatedPhotos > 0) {
        info.push(`${annotatedPhotos} photo(s) have annotations`);
    }
    
    return {
        errors,
        warnings,
        info,
        valid: errors.length === 0,
        totalItems,
        completedItems,
        failedItems,
        completionRate: Math.round(completionRate)
    };
}

function validateAndExport() {
    const validation = validateFormData();
    showValidationModal(validation);
}

function showValidationModal(validation) {
    const modal = document.getElementById('validationModal');
    const resultsDiv = document.getElementById('validationResults');
    const proceedBtn = document.getElementById('proceedExportBtn');
    
    let html = '<div class="validation-summary">';
    html += `<div class="validation-summary-item">
        <span class="validation-summary-label">Completion Rate</span>
        <span class="validation-summary-value">${validation.completionRate}% (${validation.completedItems}/${validation.totalItems})</span>
    </div>`;
    html += `<div class="validation-summary-item">
        <span class="validation-summary-label">Failed Items</span>
        <span class="validation-summary-value">${validation.failedItems}</span>
    </div>`;
    html += `<div class="validation-summary-item">
        <span class="validation-summary-label">Total Photos</span>
        <span class="validation-summary-value">${photoDatabase.length}</span>
    </div>`;
    html += '</div>';
    
    if (validation.errors.length > 0) {
        html += '<div class="validation-section">';
        html += '<h3><span class="icon error">✗</span>Required Fields Missing</h3>';
        html += '<ul class="validation-list">';
        validation.errors.forEach(err => {
            html += `<li class="error">• ${err}</li>`;
        });
        html += '</ul></div>';
    }
    
    if (validation.warnings.length > 0) {
        html += '<div class="validation-section">';
        html += '<h3><span class="icon warning">⚠</span>Warnings</h3>';
        html += '<ul class="validation-list">';
        validation.warnings.forEach(warn => {
            html += `<li class="warning">• ${warn}</li>`;
        });
        html += '</ul></div>';
    }
    
    if (validation.info.length > 0) {
        html += '<div class="validation-section">';
        html += '<h3><span class="icon success">ℹ</span>Information</h3>';
        html += '<ul class="validation-list">';
        validation.info.forEach(inf => {
            html += `<li class="success">• ${inf}</li>`;
        });
        html += '</ul></div>';
    }
    
    if (validation.valid) {
        html += '<div class="validation-section">';
        html += '<h3><span class="icon success">✓</span>Ready to Export</h3>';
        html += '<p style="color:#166534;">All required fields are complete. You can proceed with the export.</p>';
        html += '</div>';
        proceedBtn.disabled = false;
    } else {
        proceedBtn.disabled = true;
    }
    
    resultsDiv.innerHTML = html;
    modal.classList.add('active');
}

function closeValidation() {
    document.getElementById('validationModal').classList.remove('active');
}

function proceedWithExport() {
    closeValidation();
    showFilenameModal();
}

function showFilenameModal() {
    const data = getFormData();
    const validation = validateFormData();
    
    // Generate default filename
    const transformerId = data.info.transformerId || 'report';
    const date = data.info.date || new Date().toISOString().split('T')[0];
    const location = data.info.location ? '_' + data.info.location.replace(/[^a-zA-Z0-9]/g, '_').substring(0, 20) : '';
    const defaultFilename = `Transformer_Inspection_${transformerId}${location}_${date}_v0.77.xlsx`;
    
    // Set filename
    document.getElementById('exportFilename').value = defaultFilename;
    
    // Populate summary
    document.getElementById('exportSummaryId').textContent = data.info.transformerId || '-';
    document.getElementById('exportSummaryDate').textContent = data.info.date || '-';
    document.getElementById('exportSummaryInspector').textContent = data.info.inspector || '-';
    document.getElementById('exportSummaryLocation').textContent = data.info.location || '-';
    document.getElementById('exportSummaryPhotos').textContent = photoDatabase.length;
    document.getElementById('exportSummaryCompletion').textContent = validation.completionRate + '%';
    
    // Show modal
    document.getElementById('filenameModal').classList.add('active');
    
    // Focus and select filename for easy editing
    setTimeout(() => {
        const filenameInput = document.getElementById('exportFilename');
        filenameInput.focus();
        // Select just the filename part (before .xlsx)
        const extensionIndex = filenameInput.value.lastIndexOf('.xlsx');
        if (extensionIndex > 0) {
            filenameInput.setSelectionRange(0, extensionIndex);
        }
    }, 100);
}

function closeFilenameModal() {
    document.getElementById('filenameModal').classList.remove('active');
}

function confirmExport() {
    closeFilenameModal();
    
    // Get custom filename
    let filename = document.getElementById('exportFilename').value.trim();
    
    // Ensure .xlsx extension
    if (!filename.toLowerCase().endsWith('.xlsx')) {
        filename += '.xlsx';
    }
    
    // Validate filename
    if (!filename || filename === '.xlsx') {
        showAlert('Please enter a valid filename', 'error');
        showFilenameModal();
        return;
    }
    
    exportToExcel(filename);
}

function closeExportProgress() {
    document.getElementById('exportProgressModal').classList.remove('active');
}


function showSpinner() {
    document.getElementById('spinner').style.display = 'block';
}

function hideSpinner() {
    document.getElementById('spinner').style.display = 'none';
}

function showAlert(msg, type='error') {
    const alert = type === 'success' ? document.getElementById('successAlert') : document.getElementById('errorAlert');
    alert.textContent = msg;
    alert.style.display = 'block';
    setTimeout(() => alert.style.display = 'none', 5000);
}

async function exportToExcel(filename) {
    showSpinner();
    
    try {
        const wb = XLSX.utils.book_new();
        const data = getFormData();
        
        const summaryData = [
            ['POWER TRANSFORMER INSPECTION REPORT - v0.74'],
            [],
            ['Transformer Information'],
            ['Transformer ID', data.info.transformerId],
            ['Location', data.info.location],
            ['GPS Coordinates', data.info.gpsCoordinates],
            ['Manufacturer', data.info.manufacturer],
            ['Serial Number', data.info.serialNumber],
            ['Year', data.info.year],
            ['Rating (MVA)', data.info.rating],
            ['Voltage Ratio (kV)', data.info.voltage],
            ['Cooling Type', data.info.coolingType],
            ['Oil Preservation System', data.info.oilPreservationSystem],
            ['Status', data.info.status],
            ['Access Method', data.info.access],
            ['Inspection Date', data.info.date],
            ['Ambient Temperature (°C)', data.info.ambientTemp],
            ['Top oil temperature (°C)', data.info.transformerTemp],
            ['Weather Conditions', data.info.weatherConditions === 'Other' && data.info.weatherConditionsOther ? 
                `Other - ${data.info.weatherConditionsOther}` : data.info.weatherConditions],
            ['Inspector', data.info.inspector],
            ['Inspection Standard', data.info.inspectionStandard === 'Other' && data.info.inspectionStandardOther ? 
                `Other - ${data.info.inspectionStandardOther}` : data.info.inspectionStandard],
            ['Inspector Date', data.info.inspectorDate],
            ['Supervisor Date', data.info.supervisorDate],
            []
        ];
        
        let itemNum = 1;
        for (let [sectionKey, section] of Object.entries(sections)) {
            const sectionData = data.sections[sectionKey];
            summaryData.push([section.t]);
            
            if (sectionData.na) {
                summaryData.push(['Status', 'N/A - Section Not Applicable']);
            } else {
                summaryData.push(['Item', 'Description', 'Status', 'Notes', 'Photos']);
                section.items.forEach((item, i) => {
                    const itemData = sectionData.items[i];
                    const lineNum = getItemNumber(sectionKey, i);
                    const photoCount = photos.lines[lineNum] ? photos.lines[lineNum].length : 0;
                    summaryData.push([
                        itemNum++,
                        item,
                        itemData.status.toUpperCase(),
                        itemData.notes || '',
                        photoCount > 0 ? `${photoCount} photo(s)` : ''
                    ]);
                });
            }
            
            // Add section comment if present
            if (sectionData.sectionComment && sectionData.sectionComment.trim()) {
                summaryData.push(['Section Comments:', sectionData.sectionComment]);
            }
            
            summaryData.push([]);
        }
        
        summaryData.push(['Comments / Recommendations']);
        summaryData.push([data.comments || 'None']);
        summaryData.push([]);
        summaryData.push(['Photo Summary']);
        summaryData.push(['Total Photos', photoDatabase.length]);
        summaryData.push(['Rating Plate', photos.info.RatingPlate ? 'Yes' : 'No']);
        summaryData.push(['View 1', photos.info.View1 ? 'Yes' : 'No']);
        summaryData.push(['View 2', photos.info.View2 ? 'Yes' : 'No']);
        
        const ws = XLSX.utils.aoa_to_sheet(summaryData);
        ws['!cols'] = [
            {wch: 10},
            {wch: 50},
            {wch: 15},
            {wch: 40},
            {wch: 15}
        ];
        
        XLSX.utils.book_append_sheet(wb, ws, 'Inspection Report');
        
        const photoDbData = [
            ['Photo Database'],
            ['Filename', 'Timestamp', 'Line', 'Type', 'Size (MB)', 'Annotation'],
            ...photoDatabase.map(p => [
                p.filename,
                new Date(p.timestamp).toLocaleString(),
                p.lineNumber || '',
                p.photoType || '',
                (p.fileSize / (1024 * 1024)).toFixed(2),
                p.annotation || ''
            ])
        ];
        
        const wsPhotos = XLSX.utils.aoa_to_sheet(photoDbData);
        wsPhotos['!cols'] = [
            {wch: 60},
            {wch: 20},
            {wch: 10},
            {wch: 15},
            {wch: 10},
            {wch: 40}
        ];
        
        XLSX.utils.book_append_sheet(wb, wsPhotos, 'Photo Database');
        
        // Use provided filename or generate default
        const finalFilename = filename || `Transformer_Inspection_${data.info.transformerId || 'report'}_${data.info.date || 'nodate'}_v0.77.xlsx`;
        XLSX.writeFile(wb, finalFilename);
        
        hideSpinner();
        showAlert('Excel file exported successfully! Check your Downloads folder.', 'success');
        
    } catch(err) {
        hideSpinner();
        showAlert('Excel export error: ' + err.message, 'error');
    }
}

function clearAutoSave() {
    if (confirm('Clear auto-saved data? This cannot be undone.')) {
        localStorage.removeItem(CONFIG.AUTO_SAVE_KEY);
        localStorage.removeItem(CONFIG.AUTO_SAVE_KEY + '_timestamp');
        showAlert('Auto-save data cleared', 'success');
        checkStorageUsage();
    }
}

function setupSignatures() {
    setupCanvas('inspectorSig');
    setupCanvas('supervisorSig');
}

function setupCanvas(canvasId) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');
    let drawing = false;
    let isInitialized = false;
    
    // Determine signature type (inspector or supervisor)
    const sigType = canvasId.replace('Sig', '').toLowerCase();
    
    // Function to resize canvas to match display size
    const resizeCanvas = () => {
        const rect = canvas.getBoundingClientRect();
        const dpr = window.devicePixelRatio || 1;
        
        // Store the current canvas content if already initialized
        let imageData = null;
        if (isInitialized && canvas.width > 0 && canvas.height > 0) {
            try {
                imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            } catch (e) {
                // Ignore errors on first initialization
            }
        }
        
        // Set canvas internal size to match display size times device pixel ratio
        canvas.width = rect.width * dpr;
        canvas.height = rect.height * dpr;
        
        // Scale context to account for device pixel ratio
        ctx.scale(dpr, dpr);
        
        // Restore the canvas content if it existed
        if (imageData) {
            ctx.putImageData(imageData, 0, 0);
        }
        
        // Set drawing properties
        ctx.strokeStyle = '#000000';
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        
        isInitialized = true;
    };
    
    // Initialize canvas size
    resizeCanvas();
    
    // Resize on window resize
    window.addEventListener('resize', resizeCanvas);
    
    const getCoordinates = (e) => {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        return { x, y };
    };
    
    const startDrawing = (e) => {
        // Prevent drawing if signature is accepted
        if (signatureState[sigType].accepted) {
            return;
        }
        drawing = true;
        const coords = getCoordinates(e);
        ctx.beginPath();
        ctx.moveTo(coords.x, coords.y);
        
        // Enable Redo button when drawing starts
        document.getElementById(sigType + 'RedoBtn').disabled = false;
    };
    
    const draw = (e) => {
        if (!drawing) return;
        // Prevent drawing if signature is accepted
        if (signatureState[sigType].accepted) {
            return;
        }
        const coords = getCoordinates(e);
        ctx.lineTo(coords.x, coords.y);
        ctx.stroke();
        markUnsaved();
    };
    
    const stopDrawing = () => {
        drawing = false;
    };
    
    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseleave', stopDrawing);
    
    canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent('mousedown', {
            clientX: touch.clientX,
            clientY: touch.clientY
        });
        canvas.dispatchEvent(mouseEvent);
    });
    
    canvas.addEventListener('touchmove', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent('mousemove', {
            clientX: touch.clientX,
            clientY: touch.clientY
        });
        canvas.dispatchEvent(mouseEvent);
    });
    
    canvas.addEventListener('touchend', (e) => {
        e.preventDefault();
        const mouseEvent = new MouseEvent('mouseup', {});
        canvas.dispatchEvent(mouseEvent);
    });
}

function clearSignature(type) {
    const canvas = document.getElementById(type + 'Sig');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    markUnsaved();
}

function acceptSignature(type) {
    const canvas = document.getElementById(type + 'Sig');
    const overlay = document.getElementById(type + 'AcceptedOverlay');
    
    // Save the canvas data
    signatureState[type].canvasData = canvas.toDataURL();
    signatureState[type].accepted = true;
    
    // Update UI - keep both buttons visible, just disable Accept
    document.getElementById(type + 'AcceptBtn').disabled = true;
    overlay.style.display = 'flex';
    
    // Change cursor to indicate signature is locked
    canvas.style.cursor = 'not-allowed';
    
    markUnsaved();
}

function redoSignature(type) {
    const canvas = document.getElementById(type + 'Sig');
    const ctx = canvas.getContext('2d');
    
    // Clear signature state
    signatureState[type].accepted = false;
    signatureState[type].canvasData = null;
    
    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Update UI - re-enable Accept, disable Redo
    document.getElementById(type + 'AcceptBtn').disabled = false;
    document.getElementById(type + 'RedoBtn').disabled = true;
    document.getElementById(type + 'AcceptedOverlay').style.display = 'none';
    
    // Restore cursor for drawing
    canvas.style.cursor = 'crosshair';
    
    markUnsaved();
}

async function checkNetworkQuality() {
    if (!navigator.onLine) {
        connectionQuality = 'offline';
        return;
    }
    
    const startTime = Date.now();
    try {
        await fetch('https://www.google.com/favicon.ico', {mode: 'no-cors', cache: 'no-cache'});
        const endTime = Date.now();
        const latency = endTime - startTime;
        
        if (latency < 200) connectionQuality = 'good';
        else if (latency < 500) connectionQuality = 'fair';
        else connectionQuality = 'slow';
    } catch (err) {
        connectionQuality = 'offline';
    }
    
    updateNetworkStatus();
}

function updateNetworkStatus() {
    const status = document.getElementById('networkStatus');
    const text = document.getElementById('networkText');
    
    status.className = 'network-status';
    
    if (!navigator.onLine || connectionQuality === 'offline') {
        status.classList.add('offline');
        text.textContent = '📡 Offline - Data saved locally';
    } else if (connectionQuality === 'slow') {
        status.classList.add('slow');
        text.textContent = '📡 Slow connection';
        setTimeout(() => status.style.display = 'none', 5000);
    } else {
        status.classList.add('online');
        text.textContent = '📡 Online';
        setTimeout(() => status.style.display = 'none', 3000);
    }
}

async function estimateStorageUsage() {
    if ('storage' in navigator && 'estimate' in navigator.storage) {
        try {
            const estimate = await navigator.storage.estimate();
            // Use browser's actual quota, but ensure minimum 100MB to avoid false warnings
            const effectiveQuota = Math.max(estimate.quota || 0, 100 * 1024 * 1024);
            return {
                usage: estimate.usage,
                quota: effectiveQuota,
                percentage: effectiveQuota > 0 ? (estimate.usage / effectiveQuota) : 0
            };
        } catch (err) {
            console.error('Storage estimate error:', err);
        }
    }
    
    const savedData = localStorage.getItem(CONFIG.AUTO_SAVE_KEY);
    const estimatedUsage = savedData ? savedData.length : 0;  // Removed the * 2
    const estimatedQuota = 500 * 1024 * 1024;  // 500MB fallback quota
    
    return {
        usage: estimatedUsage,
        quota: estimatedQuota,
        percentage: estimatedUsage / estimatedQuota
    };
}

async function checkStorageUsage() {
    const storage = await estimateStorageUsage();
    updateStorageIndicator(storage);
    
    if (storage.percentage >= CONFIG.STORAGE_CRITICAL_THRESHOLD) {
        showStorageWarning(true);
    } else if (storage.percentage >= CONFIG.STORAGE_WARNING_THRESHOLD) {
        showStorageWarning(false);
    }
}

function updateStorageIndicator(storage) {
    const indicator = document.getElementById('storageIndicator');
    const usageMB = (storage.usage / (1024 * 1024)).toFixed(1);
    const quotaMB = (storage.quota / (1024 * 1024)).toFixed(0);
    const pct = (storage.percentage * 100).toFixed(0);
    
    indicator.textContent = `💾 ${usageMB}MB / ${quotaMB}MB (${pct}%)`;
    
    if (storage.percentage >= CONFIG.STORAGE_CRITICAL_THRESHOLD) {
        indicator.style.color = '#dc2626';
    } else if (storage.percentage >= CONFIG.STORAGE_WARNING_THRESHOLD) {
        indicator.style.color = '#f59e0b';
    } else {
        indicator.style.color = '#16a34a';
    }
}

function showStorageWarning(critical) {
    const warning = document.getElementById('storageWarning');
    const message = document.getElementById('storageMessage');
    const meter = document.getElementById('storageMeterFill');
    
    estimateStorageUsage().then(storage => {
        const pct = (storage.percentage * 100).toFixed(0);
        meter.style.width = pct + '%';
        
        if (critical) {
            warning.classList.add('critical');
            message.textContent = `Storage critically low (${pct}% full). Export and clear data immediately to continue.`;
        } else {
            warning.classList.remove('critical');
            message.textContent = `Storage space running low (${pct}% full). Consider exporting your data to free up space.`;
        }
        
        warning.classList.add('active');
    });
}

function dismissStorageWarning() {
    document.getElementById('storageWarning').classList.remove('active');
}

function handleStorageAction() {
    dismissStorageWarning();
    validateAndExport();
}

async function checkStorageBeforeUpload(files) {
    let totalSize = 0;
    for (let file of files) {
        totalSize += file.size;
    }
    
    const storage = await estimateStorageUsage();
    const availableSpace = storage.quota - storage.usage;
    
    if (totalSize * 1.5 > availableSpace) {
        showStorageWarning(true);
        return false;
    }
    
    return true;
}

function renderSections() {
    let html = '';
    let isFirstSection = true;
    
    for (let [k,s] of Object.entries(sections)) {
        const isFirst = isFirstSection;
        isFirstSection = false;
        
        html += `<div class="inspection-section">
            <div class="section-header ${isFirst ? '' : 'collapsed'}" style="background:${s.c};" id="hdr-${k}">
                <div class="title-area">
                    <span class="expand-icon" onclick="toggleSection('${k}')">${isFirst ? '<span class="expand-icon">▶</span>' : '<span class="expand-icon">▶</span>'}</span>
                    <span onclick="toggleSection('${k}')" style="flex:1; cursor:pointer;">${s.t}</span>
                    <div class="na-checkbox" onclick="event.stopPropagation();">
                        <input type="checkbox" id="na-${k}" onchange="toggleSectionNA('${k}')">
                        <label for="na-${k}">N/A</label>
                    </div>
                    <span class="completion-badge" id="badge-${k}">0/${s.items.length}</span>
                </div>
            </div>
            <div class="section-content ${isFirst ? 'expanded' : ''}" id="content-${k}">
                <table><thead><tr>
                    <th style="width:6%;">Item</th>
                    <th style="width:32%;">Description</th>
                    <th style="width:30%;">Status</th>
                    <th style="width:20%;">Notes</th>
                    <th style="width:12%;">Photo</th>
                </tr></thead><tbody>`;
        
        s.items.forEach((item,i) => {
            const itemNum = getItemNumber(k, i);
            html += `<tr id="r-${k}-${i}" style="background:#D9D9D9;">
                <td style="font-weight:600; text-align:center;">${itemNum}</td>
                <td>${sanitize(item)}</td>
                <td>
                    <div class="status-buttons" id="status-${k}-${i}">
                        ${opts.map(o=>`<button class="status-btn ${o.v} ${o.v==='skip'?'active':''}" 
                            onclick="setStatus('${k}',${i},'${o.v}')" title="${o.l}">${o.icon}</button>`).join('')}
                    </div>
                </td>
                <td>
                    <div class="textarea-wrapper">
                        <textarea id="nt-${k}-${i}" rows="2" placeholder="Notes..." maxlength="500" oninput="markUnsaved(); updateWordCount('nt-${k}-${i}', 'counter-${k}-${i}', 500)"></textarea>
                        <div class="word-counter" id="counter-${k}-${i}">0/500</div>
                    </div>
                </td>
                <td>
                    <div class="line-photo-container">
                        <input type="file" id="photo-${k}-${i}" accept="image/*" capture="environment" style="display:none;" onchange="handleLinePhoto(event, '${k}', ${i})">
                        <button class="camera-btn" onclick="document.getElementById('photo-${k}-${i}').click()">📷</button>
                        <div id="photos-${k}-${i}" class="photo-thumbnails"></div>
                    </div>
                </td>
            </tr>`;
        });
        
        html += `</tbody></table>
            <div class="bulk-actions">
                <button class="bulk-btn bulk-pass" onclick="markAllPass('${k}')">[OK] All Pass</button>
                <button class="bulk-btn bulk-skip" onclick="markAllSkip('${k}')">[ ] All Skip</button>
            </div>
            <div style="padding: 1rem; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.875rem;">Section Comments</label>
                <div class="textarea-wrapper">
                    <textarea id="section-comment-${k}" rows="3" placeholder="Additional comments for this section..." maxlength="700" style="width:100%; padding:0.5rem; border:1px solid #d1d5db; border-radius:0.375rem; font-size:0.875rem;" oninput="markUnsaved(); updateWordCount('section-comment-${k}', 'section-counter-${k}', 700)"></textarea>
                    <div class="word-counter" id="section-counter-${k}">0/700 characters</div>
                </div>
            </div>
        </div></div>`;
    }
    
    document.getElementById('sections').innerHTML = html;
}

function initGitHubLinks() {
    // Update all GitHub links with CONFIG values
    const baseUrl = `https://github.com/${CONFIG.GITHUB_USERNAME}/${CONFIG.GITHUB_REPO}`;
    
    // Update header link
    document.querySelectorAll('a[href*="github.com/YOUR-USERNAME"]').forEach(link => {
        const href = link.getAttribute('href');
        link.setAttribute('href', href.replace('YOUR-USERNAME', CONFIG.GITHUB_USERNAME).replace('transformer-inspection', CONFIG.GITHUB_REPO));
    });
    
    // Update last modified date
    const lastModifiedEl = document.getElementById('lastModified');
    if (lastModifiedEl) {
        lastModifiedEl.textContent = CONFIG.LAST_UPDATED;
    }
}

function init() {
    initGitHubLinks();  // Initialize GitHub links
    
    document.getElementById('date').valueAsDate = new Date();
    
    const yearSelect = document.getElementById('year');
    const currentYear = new Date().getFullYear();
    for(let year = currentYear; year >= 1900; year--) {
        yearSelect.add(new Option(year, year));
    }
    
    renderSections();
    setupSignatures();
    
    // Initialize word counters after sections are rendered
    setTimeout(initializeAllWordCounters, 100);
    
    updateNetworkStatus();
    checkNetworkQuality();
    checkStorageUsage();
    
    networkCheckTimer = setInterval(checkNetworkQuality, CONFIG.NETWORK_CHECK_INTERVAL);
    storageCheckTimer = setInterval(checkStorageUsage, 60000);
    
    window.addEventListener('online', () => {
        connectionQuality = 'unknown';
        checkNetworkQuality();
        showAlert('Connection restored', 'success');
    });
    
    window.addEventListener('offline', () => {
        connectionQuality = 'offline';
        updateNetworkStatus();
    });
    
    autoSaveTimer = setInterval(autoSave, CONFIG.AUTO_SAVE_INTERVAL);
    
    window.addEventListener('beforeunload', (e) => {
        if (hasUnsavedChanges) {
            e.returnValue = 'You have unsaved changes. Are you sure you want to leave?';
            return e.returnValue;
        }
    });
    
    document.addEventListener('keydown', (e) => {
        if (document.getElementById('photoViewer').classList.contains('active')) {
            if (e.key === 'Escape') closePhotoViewer();
            else if (e.key === 'ArrowLeft') navigatePhoto(-1);
            else if (e.key === 'ArrowRight') navigatePhoto(1);
        }
    });
    
    const savedData = localStorage.getItem(CONFIG.AUTO_SAVE_KEY);
    if (savedData) {
        const timestamp = localStorage.getItem(CONFIG.AUTO_SAVE_KEY + '_timestamp');
        if (timestamp) {
            const saveDate = new Date(timestamp);
            const now = new Date();
            const hoursSince = (now - saveDate) / (1000 * 60 * 60);
            
            if (hoursSince < 24) {
                showAlert(`Auto-saved data found from ${saveDate.toLocaleString()}. Click "Load" to restore.`, 'success');
            }
        }
    }
}

window.onload = init;

// === v0.63 – UX: Embedded Yes/No/Don't Know inside Notes ===
function isBinaryQuestion(text) {
  if (!text) return false;
  const t = ('' + text).trim();
  const starts = /^(is|are|does|do|has|have|was|were)\b/i.test(t);
  const qmark = /\?\s*$/.test(t);
  return starts || qmark;
}

function createYNKMenu(textarea) {
  const wrap = document.createElement('div');
  wrap.className = 'note-wrapper';
  textarea.parentNode.insertBefore(wrap, textarea);
  wrap.appendChild(textarea);

  const trigger = document.createElement('button');
  trigger.type = 'button';
  trigger.className = 'ynk-trigger';
  trigger.title = 'Quick answer';
  trigger.setAttribute('aria-label', 'Quick answer');
  trigger.textContent = '▼';

  const menu = document.createElement('div');
  menu.className = 'ynk-menu';
  const opts = [
    {label:'✅ Yes', text:'Yes – '},
    {label:'❌ No', text:'No – '},
    {label:'⚪ Don\u2019t Know', text:'Don\u2019t Know – '},
  ];
  opts.forEach(o => {
    const b = document.createElement('button');
    b.type = 'button';
    b.textContent = o.label;
    b.addEventListener('click', () => {
      const cur = textarea.value || '';
      const replaced = cur.replace(/^\s*(Yes|No|Don[\u2019']?t\s+Know)\s*[-–]\s*\s*/i, '');
      textarea.value = o.text + replaced;
      textarea.focus();
      textarea.selectionStart = textarea.selectionEnd = textarea.value.length;
      menu.classList.remove('active');
      if (typeof markUnsaved === 'function') markUnsaved();
    });
    menu.appendChild(b);
  });

  trigger.addEventListener('click', (e) => {
    e.stopPropagation();
    document.querySelectorAll('.ynk-menu.active').forEach(m => { if (m !== menu) m.classList.remove('active'); });
    menu.classList.toggle('active');
  });
  document.addEventListener('click', () => menu.classList.remove('active'));
  wrap.appendChild(trigger);
  wrap.appendChild(menu);
}

function attachBinaryDropdowns() {
  try {
    for (let [sectionKey, section] of Object.entries(sections)) {
      section.items.forEach((item, i) => {
        if (!isBinaryQuestion(item)) return;
        const ta = document.getElementById(`nt-${sectionKey}-${i}`);
        if (!ta) return;
        if (ta.parentElement && ta.parentElement.classList.contains('note-wrapper')) return;
        createYNKMenu(ta);
      });
    }
  } catch (e) {
    console.warn('YNK attach error:', e);
  }
}

window.addEventListener('load', () => {
  setTimeout(attachBinaryDropdowns, 50);
});

// v0.64 – Global collapse/expand with chevron sync + smooth animation
function setSectionState(sectionKey, expand) {
  const content = document.getElementById(`content-${sectionKey}`);
  const header = document.getElementById(`hdr-${sectionKey}`);
  if (!content || !header) return;
  if (expand) {
    content.classList.add('expanded');
    header.classList.remove('collapsed');
  } else {
    content.classList.remove('expanded');
    header.classList.add('collapsed');
  }
}

function computeGlobalState() {
  // true if at least one section is expanded
  let anyExpanded = false;
  for (let k of Object.keys(sections)) {
    const content = document.getElementById(`content-${k}`);
    if (content && content.classList.contains('expanded')) { anyExpanded = true; break; }
  }
  return anyExpanded;
}

function updateToggleAllButton() {
  const btn = document.getElementById('toggleAllBtn');
  if (!btn) return;
  const anyExpanded = computeGlobalState();
  // If any expanded, offer to Collapse All; else offer to Expand All
  btn.textContent = anyExpanded ? '▶️ Collapse All' : '🔽 Expand All';
}

function toggleAllSections() {
  const anyExpanded = computeGlobalState();
  const expand = !anyExpanded; // if any are expanded, then collapse all; else expand all
  for (let k of Object.keys(sections)) {
    setSectionState(k, expand);
  }
  updateToggleAllButton();
}

// Sync button on load and when any section toggles manually
window.addEventListener('load', () => {
  // Defer a bit to ensure sections are rendered
  setTimeout(updateToggleAllButton, 100);
});

// Patch existing toggleSection to also update global button after manual toggles
if (typeof window.toggleSection === 'function' && !window._orig_toggleSection) {
  window._orig_toggleSection = window.toggleSection;
  window.toggleSection = function(sectionKey) {
    window._orig_toggleSection(sectionKey);
    updateToggleAllButton();
  };
}

// === Sticky Header Scroll Behavior ===
let lastScrollY = 0;
let ticking = false;

function handleStickyHeaders() {
  const headerTitle = document.getElementById('headerTitle');
  const headerButtonsBlock = document.getElementById('headerButtonsBlock');
  const checklistHeader = document.getElementById('checklistHeader');
  const checklistSection = document.getElementById('checklistSection');
  
  if (!headerTitle || !headerButtonsBlock || !checklistHeader || !checklistSection) return;
  
  const scrollY = window.scrollY;
  const checklistOffset = checklistSection.offsetTop;
  
  // Minimize header when scrolling past 100px
  if (scrollY > 100) {
    headerTitle.classList.add('minimized');
    headerButtonsBlock.classList.add('minimized');
    checklistHeader.classList.add('header-minimized');
  } else {
    headerTitle.classList.remove('minimized');
    headerButtonsBlock.classList.remove('minimized');
    checklistHeader.classList.remove('header-minimized');
  }
  
  lastScrollY = scrollY;
  ticking = false;
}

function requestStickyUpdate() {
  if (!ticking) {
    window.requestAnimationFrame(handleStickyHeaders);
    ticking = true;
  }
}

// Attach scroll listener
window.addEventListener('scroll', requestStickyUpdate, { passive: true });

// Initialize on load
window.addEventListener('load', () => {
  setTimeout(() => {
    handleStickyHeaders();
  }, 200);
});

// === Print Preparation: N/A Sections Summary ===
window.addEventListener('beforeprint', () => {
  const naSections = [];
  
  // Find all sections marked as N/A
  for (let [sectionKey, section] of Object.entries(sections)) {
    const naCheckbox = document.getElementById(`na-${sectionKey}`);
    if (naCheckbox && naCheckbox.checked) {
      naSections.push(section.t);
      
      // Add class to hide this section in print
      const sectionElement = document.getElementById(`hdr-${sectionKey}`)?.closest('.inspection-section');
      if (sectionElement) {
        sectionElement.classList.add('section-na');
      }
    }
  }
  
  // Populate the N/A summary
  const summaryList = document.getElementById('naSummaryList');
  const summarySection = document.getElementById('naSummary');
  
  if (naSections.length > 0) {
    const ul = document.createElement('ul');
    naSections.forEach(sectionName => {
      const li = document.createElement('li');
      li.textContent = sectionName;
      ul.appendChild(li);
    });
    summaryList.innerHTML = '';
    summaryList.appendChild(ul);
    summarySection.style.display = 'block';
  } else {
    summarySection.style.display = 'none';
  }
});

// Clean up after printing
window.addEventListener('afterprint', () => {
  // Remove the section-na class from all sections
  document.querySelectorAll('.inspection-section.section-na').forEach(section => {
    section.classList.remove('section-na');
  });
});

// === Send via Email Functionality ===
async function sendViaEmail() {
  try {
    // Generate email subject and body
    const transformerId = document.getElementById('transformerId')?.value || 'Unknown';
    const location = document.getElementById('location')?.value || 'Unknown';
    const date = document.getElementById('inspectionDate')?.value || new Date().toISOString().split('T')[0];
    
    const subject = `Transformer Inspection Report - ${transformerId} - ${date}`;
    
    // Calculate stats
    let pass = 0, warning = 0, fail = 0, skip = 0, total = 0;
    for (let [k, section] of Object.entries(sections)) {
      const isNA = document.getElementById(`na-${k}`)?.checked;
      if (isNA) continue;
      
      section.items.forEach((item, i) => {
        total++;
        const status = getItemStatus(k, i);
        if (status === 'pass') pass++;
        else if (status === 'warning') warning++;
        else if (status === 'fail') fail++;
        else if (status === 'skip') skip++;
      });
    }
    
    const completionRate = total > 0 ? Math.round(((pass + warning + fail) / total) * 100) : 0;
    
    // Create formatted email body
    let body = `POWER TRANSFORMER INSPECTION REPORT\n`;
    body += `${'='.repeat(50)}\n\n`;
    body += `Transformer ID: ${transformerId}\n`;
    body += `Location: ${location}\n`;
    body += `Date: ${date}\n`;
    body += `Inspector: ${document.getElementById('inspectorName')?.value || 'Not specified'}\n\n`;
    
    body += `INSPECTION SUMMARY\n`;
    body += `${'-'.repeat(50)}\n`;
    body += `Completion Rate: ${completionRate}%\n`;
    body += `Total Items: ${total}\n`;
    body += `Total Photos: ${photoDatabase.length}\n\n`;
    
    body += `STATUS BREAKDOWN\n`;
    body += `${'-'.repeat(50)}\n`;
    body += `Pass: ${pass}\n`;
    body += `Warning: ${warning}\n`;
    body += `Fail: ${fail}\n`;
    body += `Skip: ${skip}\n\n`;
    
    body += `This is an automated report. Please download the full Excel/PDF report for complete details.\n`;
    
    // Check if Web Share API is available (modern browsers, Android)
    if (navigator.share && navigator.canShare) {
      // Try to generate and share files
      try {
        const filename = `${transformerId.replace(/[^a-zA-Z0-9]/g, '_')}_Inspection_${date}`;
        
        // Show progress
        showEmailSpinner('Preparing email with attachments...');
        
        // Generate Excel file
        const excelBlob = await generateExcelBlob(filename);
        const excelFile = new File([excelBlob], `${filename}.xlsx`, { 
          type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' 
        });
        
        hideEmailSpinner();
        
        // Check if we can share files
        if (navigator.canShare({ files: [excelFile] })) {
          // Use Web Share API to share with email apps
          await navigator.share({
            title: subject,
            text: body,
            files: [excelFile]
          });
          
          showEmailAlert('Email prepared successfully!', 'success');
        } else {
          // Can't share files, fall back to mailto
          fallbackToMailto(subject, body);
        }
      } catch (shareError) {
        console.error('Share error:', shareError);
        hideEmailSpinner();
        // If share fails, fall back to mailto
        fallbackToMailto(subject, body);
      }
    } else {
      // Fallback to mailto for browsers that don't support Web Share API
      fallbackToMailto(subject, body);
    }
  } catch (error) {
    console.error('Error sending email:', error);
    hideEmailSpinner();
    showEmailAlert('Error preparing email. Please try exporting the file manually.', 'error');
  }
}

// Helper function to generate Excel blob for sharing
async function generateExcelBlob(filename) {
  return new Promise((resolve, reject) => {
    try {
      const wb = XLSX.utils.book_new();
      
      // Get form data
      const transformerId = document.getElementById('transformerId')?.value || '';
      const location = document.getElementById('location')?.value || '';
      const gpsCoordinates = document.getElementById('gpsCoordinates')?.value || '';
      const manufacturer = document.getElementById('manufacturer')?.value || '';
      const rating = document.getElementById('rating')?.value || '';
      const voltage = document.getElementById('voltage')?.value || '';
      const coolingType = document.getElementById('coolingType')?.value || '';
      const oilPreservation = document.getElementById('oilPreservation')?.value || '';
      const yearManufacture = document.getElementById('yearManufacture')?.value || '';
      const serialNumber = document.getElementById('serialNumber')?.value || '';
      const inspectionDate = document.getElementById('inspectionDate')?.value || '';
      const inspectorName = document.getElementById('inspectorName')?.value || '';
      
      // Calculate stats
      let pass = 0, warning = 0, fail = 0, skip = 0, total = 0;
      for (let [k, section] of Object.entries(sections)) {
        const isNA = document.getElementById(`na-${k}`)?.checked;
        if (isNA) continue;
        
        section.items.forEach((item, i) => {
          total++;
          const status = getItemStatus(k, i);
          if (status === 'pass') pass++;
          else if (status === 'warning') warning++;
          else if (status === 'fail') fail++;
          else if (status === 'skip') skip++;
        });
      }
      
      // Summary sheet
      const summaryData = [
        ['POWER TRANSFORMER INSPECTION REPORT'],
        [''],
        ['Transformer Information'],
        ['Transformer ID', transformerId],
        ['Location', location],
        ['GPS Coordinates', gpsCoordinates],
        ['Manufacturer', manufacturer],
        ['Max. MVA', rating],
        ['Voltage Ratio (kV)', voltage],
        ['Cooling Type', coolingType],
        ['Oil Preservation', oilPreservation],
        ['Year of Manufacture', yearManufacture],
        ['Serial Number', serialNumber],
        ['Inspection Date', inspectionDate],
        ['Inspector Name', inspectorName],
        [''],
        ['Inspection Summary'],
        ['Total Items', total],
        ['Passed', pass],
        ['Warning', warning],
        ['Failed', fail],
        ['Skipped', skip],
        ['Total Photos', photoDatabase.length]
      ];
      
      const ws1 = XLSX.utils.aoa_to_sheet(summaryData);
      ws1['!cols'] = [{wch: 25}, {wch: 40}];
      XLSX.utils.book_append_sheet(wb, ws1, 'Summary');
      
      // Inspection details sheet
      const detailsData = [['Section', 'Item', 'Description', 'Status', 'Notes']];
      let itemCounter = 1;
      
      for (let [k, section] of Object.entries(sections)) {
        const isNA = document.getElementById(`na-${k}`)?.checked;
        
        section.items.forEach((item, i) => {
          const status = getItemStatus(k, i);
          const notesElement = document.getElementById(`nt-${k}-${i}`);
          const notes = notesElement ? notesElement.value : '';
          
          detailsData.push([
            section.t,
            itemCounter++,
            item,
            isNA ? 'N/A' : (status || 'skip'),
            notes
          ]);
        });
      }
      
      const ws2 = XLSX.utils.aoa_to_sheet(detailsData);
      ws2['!cols'] = [{wch: 30}, {wch: 8}, {wch: 45}, {wch: 15}, {wch: 50}];
      XLSX.utils.book_append_sheet(wb, ws2, 'Inspection Details');
      
      // Generate blob
      const wbout = XLSX.write(wb, {bookType: 'xlsx', type: 'array'});
      const blob = new Blob([wbout], {type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'});
      resolve(blob);
    } catch (error) {
      reject(error);
    }
  });
}

// Fallback function for mailto
function fallbackToMailto(subject, body) {
  const maxLength = 2000; // Safe limit for mailto body
  let truncatedBody = body;
  
  if (body.length > maxLength) {
    truncatedBody = body.substring(0, maxLength) + '\n\n[Email body truncated. Please download the full report for complete details.]';
  }
  
  const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(truncatedBody)}`;
  
  // Open mailto link
  window.location.href = mailtoLink;
  
  showEmailAlert('Email client opened. Note: Attachment not supported - please export and attach the file manually.', 'info');
}

// Helper function to show email alert
function showEmailAlert(message, type = 'info') {
  // Check if alert already exists
  let alertDiv = document.getElementById('emailAlertBox');
  
  if (!alertDiv) {
    alertDiv = document.createElement('div');
    alertDiv.id = 'emailAlertBox';
    alertDiv.style.position = 'fixed';
    alertDiv.style.top = '20px';
    alertDiv.style.left = '50%';
    alertDiv.style.transform = 'translateX(-50%)';
    alertDiv.style.zIndex = '9999';
    alertDiv.style.maxWidth = '500px';
    alertDiv.style.padding = '1rem';
    alertDiv.style.borderRadius = '0.5rem';
    alertDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
    alertDiv.style.fontWeight = '600';
    document.body.appendChild(alertDiv);
  }
  
  if (type === 'success') {
    alertDiv.style.background = '#f0fdf4';
    alertDiv.style.color = '#166534';
    alertDiv.style.borderLeft = '4px solid #16a34a';
  } else if (type === 'error') {
    alertDiv.style.background = '#fef2f2';
    alertDiv.style.color = '#991b1b';
    alertDiv.style.borderLeft = '4px solid #dc2626';
  } else {
    alertDiv.style.background = '#eff6ff';
    alertDiv.style.color = '#1e40af';
    alertDiv.style.borderLeft = '4px solid #2563eb';
  }
  
  alertDiv.textContent = message;
  alertDiv.style.display = 'block';
  
  setTimeout(() => {
    alertDiv.style.display = 'none';
  }, 5000);
}

// Helper function to show email spinner
function showEmailSpinner(message = 'Processing...') {
  let spinner = document.getElementById('emailSpinner');
  
  if (!spinner) {
    spinner = document.createElement('div');
    spinner.id = 'emailSpinner';
    spinner.style.position = 'fixed';
    spinner.style.top = '50%';
    spinner.style.left = '50%';
    spinner.style.transform = 'translate(-50%, -50%)';
    spinner.style.background = 'white';
    spinner.style.padding = '2rem';
    spinner.style.borderRadius = '0.5rem';
    spinner.style.boxShadow = '0 10px 25px rgba(0,0,0,0.3)';
    spinner.style.zIndex = '10000';
    spinner.style.textAlign = 'center';
    spinner.style.display = 'none';
    
    spinner.innerHTML = `
      <div style="margin-bottom: 1rem; font-weight: 600;" id="emailSpinnerText">${message}</div>
      <div style="width: 40px; height: 40px; border: 4px solid #e5e7eb; border-top-color: #2563eb; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
    `;
    
    document.body.appendChild(spinner);
  }
  
  const textElement = document.getElementById('emailSpinnerText');
  if (textElement) {
    textElement.textContent = message;
  }
  
  spinner.style.display = 'block';
}

// Helper function to hide email spinner
function hideEmailSpinner() {
  const spinner = document.getElementById('emailSpinner');
  if (spinner) {
    spinner.style.display = 'none';
  }
}
</script>

<div class="validation-modal" id="exportProgressModal">
  <div class="validation-content" style="max-width:600px;">
    <h2>📦 Exporting...</h2>
    <div class="validation-summary">
      <div id="exportPhase" class="validation-summary-value">Preparing data…</div>
      <div style="margin-top:0.75rem; background:#e5e7eb; height:10px; border-radius:6px; overflow:hidden;">
        <div id="exportProgressBar" style="height:10px; width:0%; background:#16a34a; transition:width 0.2s;"></div>
      </div>
    </div>
    <div style="text-align:right; margin-top:1rem;">
      <button class="cancel-btn" onclick="closeExportProgress()">Hide</button>
    </div>
  </div>
</div>

</body>
</html>